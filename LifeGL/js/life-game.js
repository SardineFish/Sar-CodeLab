!function(t){var n={};function r(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=n,r.d=function(t,n,e){r.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,n){if(1&n&&(t=r(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var i in t)r.d(e,i,function(n){return t[n]}.bind(null,i));return e},r.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(n,"a",n),n},r.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},r.p="",r(r.s=36)}([function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(4),i=r(1);class u extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return this.clone().div(o(t,t))}constructor(t,n){super(t,n)}plus(t){return this[0]+=t[0],this[1]+=t[1],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this}div(t){return this[0]/=t[0],this[1]/=t[1],this}dot(t){return this[0]*t[0]+this[1]*t[1]}normalise(){const t=this.magnitude;return this.clone().div(o(t,t))}cross(t){return this.x*t.y-this.y*t.x}clone(){return o(this[0],this[1])}to(t){switch(t){case e.Vector4:return e.vec4(this[0],this[1],0,0);case i.Vector3:return i.vec3(this[0],this[1],0)}return this.clone()}}function o(t,n){return new u(t,n)}n.Vector2=u,n.vec2=o},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(4),i=r(0);class u extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return this.clone().div(o(t,t,t))}constructor(t,n,r){super(t,n,r)}plus(t){return this[0]+=t[0],this[1]+=t[1],this[2]+=t[2],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this[2]-=t[2],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this[2]*=t[2],this}div(t){return this[0]/=t[0],this[1]/=t[1],this[2]/=t[2],this}dot(t){return this[0]*t[0]+this[1]*t[1]+this[3]*t[3]}normalise(){const t=this.magnitude;return this.clone().div(o(t,t,t))}cross(t){return o(this.y*t.z-this.z*t.y,this.x*t.z-this.z*t.x,this.x*t.y-this.y*t.x)}clone(){return o(this[0],this[1],this[2])}to(t){switch(t){case e.Vector4:return e.vec4(this[0],this[1],this[2],0);case i.Vector2:return i.vec2(this[0],this[1])}return this.clone()}}function o(t,n,r){return new u(t,n,r)}n.Vector3=u,n.vec3=o},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),r(7),n.panicNull=function(t,n){if(null===t)throw new Error(n);return t},n.panic=function(t){throw new Error(t)},n.warn=function(t){return console.warn(t),null},n.decorator=function(t,n,r=(t=>t)){const e=Symbol(t);return[t=>(void 0===t&&(t=n),Reflect.metadata(e,r(t))),(t,n)=>void 0===n?Reflect.getMetadata(e,t):Reflect.getMetadata(e,t,n)]},n.getUniformsLocation=function(t,n,r){const e={};for(const i in r)e[i]=t.getUniformLocation(n,r[i]);return e},n.fillArray=function(t,n){const r=new Array(n);for(let e=0;e<n;e++)r[e]="function"==typeof t?t(e):t;return r}},function(t,n,r){"use strict";let e;Object.defineProperty(n,"__esModule",{value:!0}),n.setGlobalContext=t=>e=t,n.GlobalContext=()=>e,n.GL=()=>n.GlobalContext().gl},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1),i=r(0);class u extends Array{get x(){return this[0]}set x(t){this[0]=t}get y(){return this[1]}set y(t){this[1]=t}get z(){return this[2]}set z(t){this[2]=t}get w(){return this[3]}set w(t){this[3]=t}get magnitude(){return Math.hypot(...this)}get normalized(){const t=this.magnitude;return this.clone().div(o(t,t,t,t))}constructor(t,n,r=0,e=0){super(t,n,r||0,e||0)}plus(t){return this[0]+=t[0],this[1]+=t[1],this[2]+=t[2],this[3]+=t[3],this}minus(t){return this[0]-=t[0],this[1]-=t[1],this[2]-=t[2],this[3]-=t[3],this}mul(t){return this[0]*=t[0],this[1]*=t[1],this[2]*=t[2],this[3]*=t[3],this}div(t){return this[0]/=t[0],this[1]/=t[1],this[2]/=t[2],this[3]/=t[3],this}dot(t){return this[0]*t[0]+this[1]*t[1]+this[2]*t[2]+this[3]*t[3]}normalise(){const t=this.magnitude;return this.clone().div(o(t,t,t,t))}clone(){return o(this[0],this[1],this[2],this[3])}to(t){switch(t){case u:return this.clone();case e.Vector3:return e.vec3(this[0],this[1],this[2]);case i.Vector2:return i.vec2(this[0],this[1])}return this.clone()}}function o(t,n,r,e){return new u(t,n,r,e)}n.Vector4=u,n.vec4=o},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(4);class i extends e.Vector4{get r(){return this[0]}set r(t){this[0]=t}get g(){return this[1]}set g(t){this[1]=t}get b(){return this[2]}set b(t){this[2]=t}get a(){return this[3]}set a(t){this[3]=t}constructor(t,n,r,e=1){super(t,n,r,e)}static get white(){return new i(1,1,1)}static get transparent(){return new i(1,1,1,0)}static get black(){return new i(0,0,0)}static get red(){return new i(1,0,0)}static get green(){return new i(0,1,0)}static get blue(){return new i(0,0,1)}}n.Color=i,n.rgba=(t,n,r,e=1)=>new i(t,n,r,e),n.rgb=(t,n,r)=>new i(t,n,r,1)},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),r(7);const e=r(3);r(7);class i{constructor(t,n=e.GL()){this.propertyBlock={},this.gl=n,this.shader=t}setup(t){var n;const r=t.gl;r.useProgram(this.shader.program);for(const e in this.propertyBlock){const i=this.propertyBlock[e];switch(i.type){case"float":r.uniform1f(i.location,this[e]);break;case"vec2":r.uniform2fv(i.location,this[e]);break;case"vec3":r.uniform3fv(i.location,this[e]);break;case"vec4":case"color":r.uniform4fv(i.location,this[e]);break;case"mat4":r.uniformMatrix4fv(i.location,!1,this[e]);break;case"tex2d":this[e]?null===(n=this[e]||null)||void 0===n||n.bind(i.location,t):t.assets.DefaultTexture.bind(i.location,t)}}}setProp(t,n,r){if(this.propertyBlock[t])this.propertyBlock[t].type=n;else{const r=this.gl.getUniformLocation(this.shader.program,t);r&&(this.propertyBlock[t]={location:r,type:n})}this[t]=r}}n.Material=i;const u=Symbol("shaderProp");n.shaderProp=function(t,n){return Reflect.metadata(u,{name:t,type:n})},n.MaterialFromShader=function(t){return class extends i{constructor(n=e.GL()){super(t,n)}}},n.materialDefine=function(t){return class extends t{constructor(...t){var n;super(...t);const r=this.gl,e=this.shader,i=this.propertyBlock;for(const t in this){const s=(o=this,a=t,Reflect.getMetadata(u,o,a));if(!s)continue;const c=r.getUniformLocation(e.program,null===(n=s)||void 0===n?void 0:n.name);c&&(i[t]={type:s.type,location:c})}var o,a;this.propertyBlock=i}}}},function(t,n,r){(function(t,n){
/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var r;!function(r){!function(e){var i="object"==typeof n?n:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),u=o(r);function o(t,n){return function(r,e){"function"!=typeof t[r]&&Object.defineProperty(t,r,{configurable:!0,writable:!0,value:e}),n&&n(r,e)}}void 0===i.Reflect?i.Reflect=r:u=o(i.Reflect,u),function(n){var r=Object.prototype.hasOwnProperty,e="function"==typeof Symbol,i=e&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",u=e&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,c={create:o?function(){return U(Object.create(null))}:a?function(){return U({__proto__:null})}:function(){return U({})},has:s?function(t,n){return r.call(t,n)}:function(t,n){return n in t},get:s?function(t,n){return r.call(t,n)?t[n]:void 0}:function(t,n){return t[n]}},f=Object.getPrototypeOf(Function),h="object"==typeof t&&t.env&&"true"===t.env.REFLECT_METADATA_USE_MAP_POLYFILL,l=h||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?function(){var t={},n=[],r=function(){function t(t,n,r){this._index=0,this._keys=t,this._values=n,this._selector=r}return t.prototype["@@iterator"]=function(){return this},t.prototype[u]=function(){return this},t.prototype.next=function(){var t=this._index;if(t>=0&&t<this._keys.length){var r=this._selector(this._keys[t],this._values[t]);return t+1>=this._keys.length?(this._index=-1,this._keys=n,this._values=n):this._index++,{value:r,done:!1}}return{value:void 0,done:!0}},t.prototype.throw=function(t){throw this._index>=0&&(this._index=-1,this._keys=n,this._values=n),t},t.prototype.return=function(t){return this._index>=0&&(this._index=-1,this._keys=n,this._values=n),{value:t,done:!0}},t}();return function(){function n(){this._keys=[],this._values=[],this._cacheKey=t,this._cacheIndex=-2}return Object.defineProperty(n.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),n.prototype.has=function(t){return this._find(t,!1)>=0},n.prototype.get=function(t){var n=this._find(t,!1);return n>=0?this._values[n]:void 0},n.prototype.set=function(t,n){var r=this._find(t,!0);return this._values[r]=n,this},n.prototype.delete=function(n){var r=this._find(n,!1);if(r>=0){for(var e=this._keys.length,i=r+1;i<e;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,n===this._cacheKey&&(this._cacheKey=t,this._cacheIndex=-2),!0}return!1},n.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=t,this._cacheIndex=-2},n.prototype.keys=function(){return new r(this._keys,this._values,e)},n.prototype.values=function(){return new r(this._keys,this._values,i)},n.prototype.entries=function(){return new r(this._keys,this._values,o)},n.prototype["@@iterator"]=function(){return this.entries()},n.prototype[u]=function(){return this.entries()},n.prototype._find=function(t,n){return this._cacheKey!==t&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=t)),this._cacheIndex<0&&n&&(this._cacheIndex=this._keys.length,this._keys.push(t),this._values.push(void 0)),this._cacheIndex},n}();function e(t,n){return t}function i(t,n){return n}function o(t,n){return[t,n]}}():Map,d=h||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?function(){function t(){this._map=new l}return Object.defineProperty(t.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),t.prototype.has=function(t){return this._map.has(t)},t.prototype.add=function(t){return this._map.set(t,t),this},t.prototype.delete=function(t){return this._map.delete(t)},t.prototype.clear=function(){this._map.clear()},t.prototype.keys=function(){return this._map.keys()},t.prototype.values=function(){return this._map.values()},t.prototype.entries=function(){return this._map.entries()},t.prototype["@@iterator"]=function(){return this.keys()},t.prototype[u]=function(){return this.keys()},t}():Set,v=new(h||"function"!=typeof WeakMap?function(){var t=c.create(),n=e();return function(){function t(){this._key=e()}return t.prototype.has=function(t){var n=i(t,!1);return void 0!==n&&c.has(n,this._key)},t.prototype.get=function(t){var n=i(t,!1);return void 0!==n?c.get(n,this._key):void 0},t.prototype.set=function(t,n){return i(t,!0)[this._key]=n,this},t.prototype.delete=function(t){var n=i(t,!1);return void 0!==n&&delete n[this._key]},t.prototype.clear=function(){this._key=e()},t}();function e(){var n;do{n="@@WeakMap@@"+o()}while(c.has(t,n));return t[n]=!0,n}function i(t,e){if(!r.call(t,n)){if(!e)return;Object.defineProperty(t,n,{value:c.create()})}return t[n]}function u(t,n){for(var r=0;r<n;++r)t[r]=255*Math.random()|0;return t}function o(){var t,n=(t=16,"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(t)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(t)):u(new Uint8Array(t),t):u(new Array(t),t));n[6]=79&n[6]|64,n[8]=191&n[8]|128;for(var r="",e=0;e<16;++e){var i=n[e];4!==e&&6!==e&&8!==e||(r+="-"),i<16&&(r+="0"),r+=i.toString(16).toLowerCase()}return r}}():WeakMap);function m(t,n,r){var e=v.get(t);if(x(e)){if(!r)return;e=new l,v.set(t,e)}var i=e.get(n);if(x(i)){if(!r)return;i=new l,e.set(n,i)}return i}function p(t,n,r){var e=m(n,r,!1);return!x(e)&&!!e.has(t)}function M(t,n,r){var e=m(n,r,!1);if(!x(e))return e.get(t)}function g(t,n,r,e){m(r,e,!0).set(t,n)}function b(t,n){var r=[],e=m(t,n,!1);if(x(e))return r;for(var i=function(t){var n=B(t,u);if(!A(n))throw new TypeError;var r=n.call(t);if(!_(r))throw new TypeError;return r}(e.keys()),o=0;;){var a=F(i);if(!a)return r.length=o,r;var s=a.value;try{r[o]=s}catch(t){try{G(i)}finally{throw t}}o++}}function y(t){if(null===t)return 1;switch(typeof t){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===t?1:6;default:return 6}}function x(t){return void 0===t}function T(t){return null===t}function _(t){return"object"==typeof t?null!==t:"function"==typeof t}function w(t,n){switch(y(t)){case 0:case 1:case 2:case 3:case 4:case 5:return t}var r=3===n?"string":5===n?"number":"default",e=B(t,i);if(void 0!==e){var u=e.call(t,r);if(_(u))throw new TypeError;return u}return function(t,n){if("string"===n){var r=t.toString;if(A(r))if(!_(i=r.call(t)))return i;if(A(e=t.valueOf))if(!_(i=e.call(t)))return i}else{var e;if(A(e=t.valueOf))if(!_(i=e.call(t)))return i;var i,u=t.toString;if(A(u))if(!_(i=u.call(t)))return i}throw new TypeError}(t,"default"===r?"number":r)}function R(t){var n=w(t,3);return"symbol"==typeof n?n:function(t){return""+t}(n)}function E(t){return Array.isArray?Array.isArray(t):t instanceof Object?t instanceof Array:"[object Array]"===Object.prototype.toString.call(t)}function A(t){return"function"==typeof t}function S(t){return"function"==typeof t}function B(t,n){var r=t[n];if(null!=r){if(!A(r))throw new TypeError;return r}}function F(t){var n=t.next();return!n.done&&n}function G(t){var n=t.return;n&&n.call(t)}function P(t){var n=Object.getPrototypeOf(t);if("function"!=typeof t||t===f)return n;if(n!==f)return n;var r=t.prototype,e=r&&Object.getPrototypeOf(r);if(null==e||e===Object.prototype)return n;var i=e.constructor;return"function"!=typeof i?n:i===t?n:i}function U(t){return t.__=void 0,delete t.__,t}n("decorate",(function(t,n,r,e){if(x(r)){if(!E(t))throw new TypeError;if(!S(n))throw new TypeError;return function(t,n){for(var r=t.length-1;r>=0;--r){var e=(0,t[r])(n);if(!x(e)&&!T(e)){if(!S(e))throw new TypeError;n=e}}return n}(t,n)}if(!E(t))throw new TypeError;if(!_(n))throw new TypeError;if(!_(e)&&!x(e)&&!T(e))throw new TypeError;return T(e)&&(e=void 0),function(t,n,r,e){for(var i=t.length-1;i>=0;--i){var u=(0,t[i])(n,r,e);if(!x(u)&&!T(u)){if(!_(u))throw new TypeError;e=u}}return e}(t,n,r=R(r),e)})),n("metadata",(function(t,n){return function(r,e){if(!_(r))throw new TypeError;if(!x(e)&&!function(t){switch(y(t)){case 3:case 4:return!0;default:return!1}}(e))throw new TypeError;g(t,n,r,e)}})),n("defineMetadata",(function(t,n,r,e){if(!_(r))throw new TypeError;return x(e)||(e=R(e)),g(t,n,r,e)})),n("hasMetadata",(function(t,n,r){if(!_(n))throw new TypeError;return x(r)||(r=R(r)),function t(n,r,e){if(p(n,r,e))return!0;var i=P(r);return!T(i)&&t(n,i,e)}(t,n,r)})),n("hasOwnMetadata",(function(t,n,r){if(!_(n))throw new TypeError;return x(r)||(r=R(r)),p(t,n,r)})),n("getMetadata",(function(t,n,r){if(!_(n))throw new TypeError;return x(r)||(r=R(r)),function t(n,r,e){if(p(n,r,e))return M(n,r,e);var i=P(r);return T(i)?void 0:t(n,i,e)}(t,n,r)})),n("getOwnMetadata",(function(t,n,r){if(!_(n))throw new TypeError;return x(r)||(r=R(r)),M(t,n,r)})),n("getMetadataKeys",(function(t,n){if(!_(t))throw new TypeError;return x(n)||(n=R(n)),function t(n,r){var e=b(n,r),i=P(n);if(null===i)return e;var u=t(i,r);if(u.length<=0)return e;if(e.length<=0)return u;for(var o=new d,a=[],s=0,c=e;s<c.length;s++){var f=c[s];o.has(f)||(o.add(f),a.push(f))}for(var h=0,l=u;h<l.length;h++){f=l[h];o.has(f)||(o.add(f),a.push(f))}return a}(t,n)})),n("getOwnMetadataKeys",(function(t,n){if(!_(t))throw new TypeError;return x(n)||(n=R(n)),b(t,n)})),n("deleteMetadata",(function(t,n,r){if(!_(n))throw new TypeError;x(r)||(r=R(r));var e=m(n,r,!1);if(x(e))return!1;if(!e.delete(t))return!1;if(e.size>0)return!0;var i=v.get(n);return i.delete(r),i.size>0||(v.delete(n),!0)}))}(u)}()}(r||(r={}))}).call(this,r(23),r(24))},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(3),i=r(12),u=r(2);var o,a;!function(t){t[t.Linear=WebGL2RenderingContext.LINEAR]="Linear",t[t.Nearest=WebGL2RenderingContext.NEAREST]="Nearest"}(o=n.FilterMode||(n.FilterMode={})),function(t){t[t.Repeat=WebGL2RenderingContext.REPEAT]="Repeat",t[t.Clamp=WebGL2RenderingContext.CLAMP_TO_EDGE]="Clamp",t[t.Mirror=WebGL2RenderingContext.MIRRORED_REPEAT]="Mirror"}(a=n.WrapMode||(n.WrapMode={}));class s{constructor(t,n,r=i.TextureFormat.RGBA,s=o.Linear,c=e.GlobalContext()){var f;this.mipmapLevel=0,this.wrapMode=a.Repeat;const h=c.gl;this.ctx=c,this.format=r,this.width=t,this.height=n,this.filterMode=s,this.glTex=null!=(f=h.createTexture())?f:u.panic("Failed to create texture.")}setup(){const t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this.glTex),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.filterMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.wrapMode),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.wrapMode)}bind(t,n){const r=n.gl;r.activeTexture(r.TEXTURE0+n.nextTextureUnit),r.bindTexture(r.TEXTURE_2D,this.glTex),r.uniform1i(t,n.nextTextureUnit),n.nextTextureUnit++}}n.Texture2D=class extends s{constructor(t=0,n=0,r=i.TextureFormat.RGBA,u=o.Linear,a=e.GlobalContext()){super(t,n,r,u,a)}setData(t){super.setup();const n=this.ctx.gl,[r,e,u]=i.mapGLFormat(n,this.format);void 0!==t.width&&void 0!==t.height?(t=t,this.width=t.width,this.height=t.height,n.texImage2D(n.TEXTURE_2D,this.mipmapLevel,r,this.width,this.height,0,e,u,null)):n.texImage2D(n.TEXTURE_2D,this.mipmapLevel,r,this.width,this.height,0,e,u,null),f(this.ctx,this.glTex,t,this.width,this.height,this.format,this.filterMode,this.wrapMode,this.mipmapLevel)}};class c extends s{constructor(t,n,r=e.GlobalContext()){super(t,n,i.TextureFormat.DEPTH_COMPONENT,o.Nearest,r)}create(){super.setup();const t=this.ctx.gl;t.bindTexture(t.TEXTURE_2D,this.glTex);const[n,r,e]=i.mapGLFormat(t,i.TextureFormat.DEPTH_COMPONENT);t.texImage2D(t.TEXTURE_2D,this.mipmapLevel,n,this.width,this.height,0,r,e,null)}}n.DepthTexture=c;function f(t,n,r,e,o,a,s,c,f){var h,l;const d=t.gl,v=null!=(h=d.createTexture())?h:u.panic("Failed to create texture."),[m,p,M]=i.mapGLFormat(d,a);d.bindTexture(d.TEXTURE_2D,v),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,c),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,c),void 0!==r.width&&void 0!==r.height?(r=r,d.texImage2D(d.TEXTURE_2D,f,m,p,M,r)):(r=r,d.texImage2D(d.TEXTURE_2D,f,m,e,o,0,p,M,r));const g=null!=(l=d.createFramebuffer())?l:u.panic("Failed to create frame buffer");d.bindFramebuffer(d.FRAMEBUFFER,g),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,n,0),d.viewport(0,0,e,o),d.drawBuffers([d.COLOR_ATTACHMENT0]);const b=t.assets.shaders.FlipTexture;d.useProgram(b.program),d.activeTexture(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,v),d.uniform1i(b.builtinUniformLocations.mainTex,0);const y=t.assets.meshes.screenQuad;y.bind(b,d),d.drawElements(d.TRIANGLE_STRIP,y.triangles.length,d.UNSIGNED_INT,0),d.deleteFramebuffer(g),d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteTexture(v)}n.RenderTexture=class extends s{constructor(t,n,r,u=i.TextureFormat.RGBA,a=o.Linear,s=e.GlobalContext()){super(t,n,u,a,s),this.depthTexture=null,r&&(this.depthTexture=new c(t,n,s)),this.update()}update(){super.setup();const t=this.ctx.gl,[n,r,e]=i.mapGLFormat(t,this.format);t.texImage2D(t.TEXTURE_2D,this.mipmapLevel,n,this.width,this.height,0,r,e,null)}setData(t){const n=this.ctx.gl;n.bindTexture(n.TEXTURE_2D,this.glTex);const[r,e,u]=i.mapGLFormat(n,this.format);n.texImage2D(n.TEXTURE_2D,this.mipmapLevel,r,this.width,this.height,0,e,u,null),f(this.ctx,this.glTex,t,this.width,this.height,this.format,this.filterMode,this.wrapMode,this.mipmapLevel)}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(2),i=r(3),u=r(10),o=r(2);n.Shader=class{constructor(t,n,r=u.BuiltinShaderSources.DefaultShaderAttributes,a=i.GL()){this._compiled=!1,this.gl=a,this.program=e.panicNull(a.createProgram(),"Failed to create shader program"),this.vertexShaderSource=t,this.fragmentShaderSouce=n,this.vertexShader=e.panicNull(a.createShader(a.VERTEX_SHADER),"Failed to create vertex shader"),this.fragmentShader=e.panicNull(a.createShader(a.FRAGMENT_SHADER),"Failed to create fragment shader"),this.compile(),this.attributes={vert:this.gl.getAttribLocation(this.program,r.vert),color:this.gl.getAttribLocation(this.program,r.color),uv:this.gl.getAttribLocation(this.program,r.uv),normal:this.gl.getAttribLocation(this.program,r.normal)},this.builtinUniformLocations=o.getUniformsLocation(a,this.program,u.BuiltinUniforms)}get compiled(){return this._compiled}compile(){if(this.gl.shaderSource(this.vertexShader,this.vertexShaderSource),this.gl.compileShader(this.vertexShader),!this.gl.getShaderParameter(this.vertexShader,this.gl.COMPILE_STATUS))throw new Error("Failed to compile vertex shader:\r\n"+this.gl.getShaderInfoLog(this.vertexShader));if(this.gl.shaderSource(this.fragmentShader,this.fragmentShaderSouce),this.gl.compileShader(this.fragmentShader),!this.gl.getShaderParameter(this.fragmentShader,this.gl.COMPILE_STATUS))throw new Error("Failed to compile fragment shader:\r\n"+this.gl.getShaderInfoLog(this.fragmentShader));if(this.gl.attachShader(this.program,this.vertexShader),this.gl.attachShader(this.program,this.fragmentShader),this.gl.linkProgram(this.program),!this.gl.getProgramParameter(this.program,this.gl.LINK_STATUS))throw new Error("Failed to link shader program:\r\n"+this.gl.getProgramInfoLog(this.program))}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(9);n.BuiltinShaderSources={DefaultVert:"#version 300 es\nprecision mediump float;\n\nin vec3 aPos;\nin vec4 aColor;\nin vec2 aUV;\nin vec3 aNormal;\n\nuniform mat4 uTransformM;\nuniform mat4 uTransformVP;\nuniform mat4 uTransformMVP;\n\nuniform vec4 uColor;\n\nout vec4 vColor;\nout vec4 vPos;\nout vec2 vUV;\nout vec3 vNormal;\n\nvoid main()\n{\n    gl_Position = uTransformMVP * vec4(aPos, 1);\n    vColor = aColor * uColor;\n    vUV = aUV;\n    vNormal = aNormal;\n}\n",DefaultFrag:"#version 300 es\nprecision mediump float;\n\nin vec4 vColor;\nin vec4 vPos;\nin vec2 vUV;\n\nuniform sampler2D uMainTex;\nuniform vec4 uColor;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    vec4 color = texture(uMainTex, vUV.xy).rgba;\n    color = color * uColor;\n    fragColor = color;\n}\n",BlitCopyFrag:"#version 300 es\nprecision mediump float;\n\nin vec4 vColor;\nin vec4 vPos;\nin vec2 vUV;\nin vec3 vNormal;\n\nuniform sampler2D uMainTex;\n\nout vec4 fragColor;\n\nvoid main()\n{\n    fragColor = texture(uMainTex, vUV).rgba;\n}\n",FlipTexVert:"#version 300 es\nprecision mediump float;\n\nin vec3 aPos;\nin vec2 aUV;\n\nout vec2 vUV;\n\nvoid main()\n{\n    gl_Position = vec4(aPos, 1);\n    vUV = vec2(aUV.x, vec2(1) - aUV.y);\n}",DefaultShaderAttributes:{vert:"aPos",color:"aColor",uv:"aUV",normal:"aNormal"}},n.BuiltinUniforms={matM:"uTransformM",matVP:"uTransformVP",matMVP:"uTransformMVP",flipUV:"uFlipUV",mainTex:"uMainTex"},n.compileBuiltinShaders=function(t){return{DefaultShader:new e.Shader(n.BuiltinShaderSources.DefaultVert,n.BuiltinShaderSources.DefaultFrag,n.BuiltinShaderSources.DefaultShaderAttributes,t),BlitCopy:new e.Shader(n.BuiltinShaderSources.DefaultVert,n.BuiltinShaderSources.BlitCopyFrag,n.BuiltinShaderSources.DefaultShaderAttributes,t),FlipTexture:new e.Shader(n.BuiltinShaderSources.FlipTexVert,n.BuiltinShaderSources.BlitCopyFrag,n.BuiltinShaderSources.DefaultShaderAttributes,t)}}},function(t,n,r){"use strict";r.r(n);var e={};r.r(e),r.d(e,"EPSILON",(function(){return d})),r.d(e,"ARRAY_TYPE",(function(){return v})),r.d(e,"RANDOM",(function(){return m})),r.d(e,"setMatrixArrayType",(function(){return p})),r.d(e,"toRadian",(function(){return g})),r.d(e,"equals",(function(){return b}));var i={};r.r(i),r.d(i,"create",(function(){return y})),r.d(i,"clone",(function(){return x})),r.d(i,"copy",(function(){return T})),r.d(i,"identity",(function(){return _})),r.d(i,"fromValues",(function(){return w})),r.d(i,"set",(function(){return R})),r.d(i,"transpose",(function(){return E})),r.d(i,"invert",(function(){return A})),r.d(i,"adjoint",(function(){return S})),r.d(i,"determinant",(function(){return B})),r.d(i,"multiply",(function(){return F})),r.d(i,"rotate",(function(){return G})),r.d(i,"scale",(function(){return P})),r.d(i,"fromRotation",(function(){return U})),r.d(i,"fromScaling",(function(){return L})),r.d(i,"str",(function(){return N})),r.d(i,"frob",(function(){return D})),r.d(i,"LDU",(function(){return C})),r.d(i,"add",(function(){return I})),r.d(i,"subtract",(function(){return O})),r.d(i,"exactEquals",(function(){return V})),r.d(i,"equals",(function(){return j})),r.d(i,"multiplyScalar",(function(){return q})),r.d(i,"multiplyScalarAndAdd",(function(){return k})),r.d(i,"mul",(function(){return z})),r.d(i,"sub",(function(){return H}));var u={};r.r(u),r.d(u,"create",(function(){return X})),r.d(u,"clone",(function(){return Y})),r.d(u,"copy",(function(){return W})),r.d(u,"identity",(function(){return K})),r.d(u,"fromValues",(function(){return Q})),r.d(u,"set",(function(){return Z})),r.d(u,"invert",(function(){return J})),r.d(u,"determinant",(function(){return $})),r.d(u,"multiply",(function(){return tt})),r.d(u,"rotate",(function(){return nt})),r.d(u,"scale",(function(){return rt})),r.d(u,"translate",(function(){return et})),r.d(u,"fromRotation",(function(){return it})),r.d(u,"fromScaling",(function(){return ut})),r.d(u,"fromTranslation",(function(){return ot})),r.d(u,"str",(function(){return at})),r.d(u,"frob",(function(){return st})),r.d(u,"add",(function(){return ct})),r.d(u,"subtract",(function(){return ft})),r.d(u,"multiplyScalar",(function(){return ht})),r.d(u,"multiplyScalarAndAdd",(function(){return lt})),r.d(u,"exactEquals",(function(){return dt})),r.d(u,"equals",(function(){return vt})),r.d(u,"mul",(function(){return mt})),r.d(u,"sub",(function(){return pt}));var o={};r.r(o),r.d(o,"create",(function(){return Mt})),r.d(o,"fromMat4",(function(){return gt})),r.d(o,"clone",(function(){return bt})),r.d(o,"copy",(function(){return yt})),r.d(o,"fromValues",(function(){return xt})),r.d(o,"set",(function(){return Tt})),r.d(o,"identity",(function(){return _t})),r.d(o,"transpose",(function(){return wt})),r.d(o,"invert",(function(){return Rt})),r.d(o,"adjoint",(function(){return Et})),r.d(o,"determinant",(function(){return At})),r.d(o,"multiply",(function(){return St})),r.d(o,"translate",(function(){return Bt})),r.d(o,"rotate",(function(){return Ft})),r.d(o,"scale",(function(){return Gt})),r.d(o,"fromTranslation",(function(){return Pt})),r.d(o,"fromRotation",(function(){return Ut})),r.d(o,"fromScaling",(function(){return Lt})),r.d(o,"fromMat2d",(function(){return Nt})),r.d(o,"fromQuat",(function(){return Dt})),r.d(o,"normalFromMat4",(function(){return Ct})),r.d(o,"projection",(function(){return It})),r.d(o,"str",(function(){return Ot})),r.d(o,"frob",(function(){return Vt})),r.d(o,"add",(function(){return jt})),r.d(o,"subtract",(function(){return qt})),r.d(o,"multiplyScalar",(function(){return kt})),r.d(o,"multiplyScalarAndAdd",(function(){return zt})),r.d(o,"exactEquals",(function(){return Ht})),r.d(o,"equals",(function(){return Xt})),r.d(o,"mul",(function(){return Yt})),r.d(o,"sub",(function(){return Wt}));var a={};r.r(a),r.d(a,"create",(function(){return Kt})),r.d(a,"clone",(function(){return Qt})),r.d(a,"copy",(function(){return Zt})),r.d(a,"fromValues",(function(){return Jt})),r.d(a,"set",(function(){return $t})),r.d(a,"identity",(function(){return tn})),r.d(a,"transpose",(function(){return nn})),r.d(a,"invert",(function(){return rn})),r.d(a,"adjoint",(function(){return en})),r.d(a,"determinant",(function(){return un})),r.d(a,"multiply",(function(){return on})),r.d(a,"translate",(function(){return an})),r.d(a,"scale",(function(){return sn})),r.d(a,"rotate",(function(){return cn})),r.d(a,"rotateX",(function(){return fn})),r.d(a,"rotateY",(function(){return hn})),r.d(a,"rotateZ",(function(){return ln})),r.d(a,"fromTranslation",(function(){return dn})),r.d(a,"fromScaling",(function(){return vn})),r.d(a,"fromRotation",(function(){return mn})),r.d(a,"fromXRotation",(function(){return pn})),r.d(a,"fromYRotation",(function(){return Mn})),r.d(a,"fromZRotation",(function(){return gn})),r.d(a,"fromRotationTranslation",(function(){return bn})),r.d(a,"fromQuat2",(function(){return yn})),r.d(a,"getTranslation",(function(){return xn})),r.d(a,"getScaling",(function(){return Tn})),r.d(a,"getRotation",(function(){return _n})),r.d(a,"fromRotationTranslationScale",(function(){return wn})),r.d(a,"fromRotationTranslationScaleOrigin",(function(){return Rn})),r.d(a,"fromQuat",(function(){return En})),r.d(a,"frustum",(function(){return An})),r.d(a,"perspective",(function(){return Sn})),r.d(a,"perspectiveFromFieldOfView",(function(){return Bn})),r.d(a,"ortho",(function(){return Fn})),r.d(a,"lookAt",(function(){return Gn})),r.d(a,"targetTo",(function(){return Pn})),r.d(a,"str",(function(){return Un})),r.d(a,"frob",(function(){return Ln})),r.d(a,"add",(function(){return Nn})),r.d(a,"subtract",(function(){return Dn})),r.d(a,"multiplyScalar",(function(){return Cn})),r.d(a,"multiplyScalarAndAdd",(function(){return In})),r.d(a,"exactEquals",(function(){return On})),r.d(a,"equals",(function(){return Vn})),r.d(a,"mul",(function(){return jn})),r.d(a,"sub",(function(){return qn}));var s={};r.r(s),r.d(s,"create",(function(){return kn})),r.d(s,"clone",(function(){return zn})),r.d(s,"length",(function(){return Hn})),r.d(s,"fromValues",(function(){return Xn})),r.d(s,"copy",(function(){return Yn})),r.d(s,"set",(function(){return Wn})),r.d(s,"add",(function(){return Kn})),r.d(s,"subtract",(function(){return Qn})),r.d(s,"multiply",(function(){return Zn})),r.d(s,"divide",(function(){return Jn})),r.d(s,"ceil",(function(){return $n})),r.d(s,"floor",(function(){return tr})),r.d(s,"min",(function(){return nr})),r.d(s,"max",(function(){return rr})),r.d(s,"round",(function(){return er})),r.d(s,"scale",(function(){return ir})),r.d(s,"scaleAndAdd",(function(){return ur})),r.d(s,"distance",(function(){return or})),r.d(s,"squaredDistance",(function(){return ar})),r.d(s,"squaredLength",(function(){return sr})),r.d(s,"negate",(function(){return cr})),r.d(s,"inverse",(function(){return fr})),r.d(s,"normalize",(function(){return hr})),r.d(s,"dot",(function(){return lr})),r.d(s,"cross",(function(){return dr})),r.d(s,"lerp",(function(){return vr})),r.d(s,"hermite",(function(){return mr})),r.d(s,"bezier",(function(){return pr})),r.d(s,"random",(function(){return Mr})),r.d(s,"transformMat4",(function(){return gr})),r.d(s,"transformMat3",(function(){return br})),r.d(s,"transformQuat",(function(){return yr})),r.d(s,"rotateX",(function(){return xr})),r.d(s,"rotateY",(function(){return Tr})),r.d(s,"rotateZ",(function(){return _r})),r.d(s,"angle",(function(){return wr})),r.d(s,"zero",(function(){return Rr})),r.d(s,"str",(function(){return Er})),r.d(s,"exactEquals",(function(){return Ar})),r.d(s,"equals",(function(){return Sr})),r.d(s,"sub",(function(){return Fr})),r.d(s,"mul",(function(){return Gr})),r.d(s,"div",(function(){return Pr})),r.d(s,"dist",(function(){return Ur})),r.d(s,"sqrDist",(function(){return Lr})),r.d(s,"len",(function(){return Nr})),r.d(s,"sqrLen",(function(){return Dr})),r.d(s,"forEach",(function(){return Cr}));var c={};r.r(c),r.d(c,"create",(function(){return Ir})),r.d(c,"clone",(function(){return Or})),r.d(c,"fromValues",(function(){return Vr})),r.d(c,"copy",(function(){return jr})),r.d(c,"set",(function(){return qr})),r.d(c,"add",(function(){return kr})),r.d(c,"subtract",(function(){return zr})),r.d(c,"multiply",(function(){return Hr})),r.d(c,"divide",(function(){return Xr})),r.d(c,"ceil",(function(){return Yr})),r.d(c,"floor",(function(){return Wr})),r.d(c,"min",(function(){return Kr})),r.d(c,"max",(function(){return Qr})),r.d(c,"round",(function(){return Zr})),r.d(c,"scale",(function(){return Jr})),r.d(c,"scaleAndAdd",(function(){return $r})),r.d(c,"distance",(function(){return te})),r.d(c,"squaredDistance",(function(){return ne})),r.d(c,"length",(function(){return re})),r.d(c,"squaredLength",(function(){return ee})),r.d(c,"negate",(function(){return ie})),r.d(c,"inverse",(function(){return ue})),r.d(c,"normalize",(function(){return oe})),r.d(c,"dot",(function(){return ae})),r.d(c,"cross",(function(){return se})),r.d(c,"lerp",(function(){return ce})),r.d(c,"random",(function(){return fe})),r.d(c,"transformMat4",(function(){return he})),r.d(c,"transformQuat",(function(){return le})),r.d(c,"zero",(function(){return de})),r.d(c,"str",(function(){return ve})),r.d(c,"exactEquals",(function(){return me})),r.d(c,"equals",(function(){return pe})),r.d(c,"sub",(function(){return Me})),r.d(c,"mul",(function(){return ge})),r.d(c,"div",(function(){return be})),r.d(c,"dist",(function(){return ye})),r.d(c,"sqrDist",(function(){return xe})),r.d(c,"len",(function(){return Te})),r.d(c,"sqrLen",(function(){return _e})),r.d(c,"forEach",(function(){return we}));var f={};r.r(f),r.d(f,"create",(function(){return Re})),r.d(f,"identity",(function(){return Ee})),r.d(f,"setAxisAngle",(function(){return Ae})),r.d(f,"getAxisAngle",(function(){return Se})),r.d(f,"getAngle",(function(){return Be})),r.d(f,"multiply",(function(){return Fe})),r.d(f,"rotateX",(function(){return Ge})),r.d(f,"rotateY",(function(){return Pe})),r.d(f,"rotateZ",(function(){return Ue})),r.d(f,"calculateW",(function(){return Le})),r.d(f,"exp",(function(){return Ne})),r.d(f,"ln",(function(){return De})),r.d(f,"pow",(function(){return Ce})),r.d(f,"slerp",(function(){return Ie})),r.d(f,"random",(function(){return Oe})),r.d(f,"invert",(function(){return Ve})),r.d(f,"conjugate",(function(){return je})),r.d(f,"fromMat3",(function(){return qe})),r.d(f,"fromEuler",(function(){return ke})),r.d(f,"str",(function(){return ze})),r.d(f,"clone",(function(){return Ze})),r.d(f,"fromValues",(function(){return Je})),r.d(f,"copy",(function(){return $e})),r.d(f,"set",(function(){return ti})),r.d(f,"add",(function(){return ni})),r.d(f,"mul",(function(){return ri})),r.d(f,"scale",(function(){return ei})),r.d(f,"dot",(function(){return ii})),r.d(f,"lerp",(function(){return ui})),r.d(f,"length",(function(){return oi})),r.d(f,"len",(function(){return ai})),r.d(f,"squaredLength",(function(){return si})),r.d(f,"sqrLen",(function(){return ci})),r.d(f,"normalize",(function(){return fi})),r.d(f,"exactEquals",(function(){return hi})),r.d(f,"equals",(function(){return li})),r.d(f,"rotationTo",(function(){return di})),r.d(f,"sqlerp",(function(){return vi})),r.d(f,"setAxes",(function(){return mi}));var h={};r.r(h),r.d(h,"create",(function(){return pi})),r.d(h,"clone",(function(){return Mi})),r.d(h,"fromValues",(function(){return gi})),r.d(h,"fromRotationTranslationValues",(function(){return bi})),r.d(h,"fromRotationTranslation",(function(){return yi})),r.d(h,"fromTranslation",(function(){return xi})),r.d(h,"fromRotation",(function(){return Ti})),r.d(h,"fromMat4",(function(){return _i})),r.d(h,"copy",(function(){return wi})),r.d(h,"identity",(function(){return Ri})),r.d(h,"set",(function(){return Ei})),r.d(h,"getReal",(function(){return Ai})),r.d(h,"getDual",(function(){return Si})),r.d(h,"setReal",(function(){return Bi})),r.d(h,"setDual",(function(){return Fi})),r.d(h,"getTranslation",(function(){return Gi})),r.d(h,"translate",(function(){return Pi})),r.d(h,"rotateX",(function(){return Ui})),r.d(h,"rotateY",(function(){return Li})),r.d(h,"rotateZ",(function(){return Ni})),r.d(h,"rotateByQuatAppend",(function(){return Di})),r.d(h,"rotateByQuatPrepend",(function(){return Ci})),r.d(h,"rotateAroundAxis",(function(){return Ii})),r.d(h,"add",(function(){return Oi})),r.d(h,"multiply",(function(){return Vi})),r.d(h,"mul",(function(){return ji})),r.d(h,"scale",(function(){return qi})),r.d(h,"dot",(function(){return ki})),r.d(h,"lerp",(function(){return zi})),r.d(h,"invert",(function(){return Hi})),r.d(h,"conjugate",(function(){return Xi})),r.d(h,"length",(function(){return Yi})),r.d(h,"len",(function(){return Wi})),r.d(h,"squaredLength",(function(){return Ki})),r.d(h,"sqrLen",(function(){return Qi})),r.d(h,"normalize",(function(){return Zi})),r.d(h,"str",(function(){return Ji})),r.d(h,"exactEquals",(function(){return $i})),r.d(h,"equals",(function(){return tu}));var l={};r.r(l),r.d(l,"create",(function(){return nu})),r.d(l,"clone",(function(){return ru})),r.d(l,"fromValues",(function(){return eu})),r.d(l,"copy",(function(){return iu})),r.d(l,"set",(function(){return uu})),r.d(l,"add",(function(){return ou})),r.d(l,"subtract",(function(){return au})),r.d(l,"multiply",(function(){return su})),r.d(l,"divide",(function(){return cu})),r.d(l,"ceil",(function(){return fu})),r.d(l,"floor",(function(){return hu})),r.d(l,"min",(function(){return lu})),r.d(l,"max",(function(){return du})),r.d(l,"round",(function(){return vu})),r.d(l,"scale",(function(){return mu})),r.d(l,"scaleAndAdd",(function(){return pu})),r.d(l,"distance",(function(){return Mu})),r.d(l,"squaredDistance",(function(){return gu})),r.d(l,"length",(function(){return bu})),r.d(l,"squaredLength",(function(){return yu})),r.d(l,"negate",(function(){return xu})),r.d(l,"inverse",(function(){return Tu})),r.d(l,"normalize",(function(){return _u})),r.d(l,"dot",(function(){return wu})),r.d(l,"cross",(function(){return Ru})),r.d(l,"lerp",(function(){return Eu})),r.d(l,"random",(function(){return Au})),r.d(l,"transformMat2",(function(){return Su})),r.d(l,"transformMat2d",(function(){return Bu})),r.d(l,"transformMat3",(function(){return Fu})),r.d(l,"transformMat4",(function(){return Gu})),r.d(l,"rotate",(function(){return Pu})),r.d(l,"angle",(function(){return Uu})),r.d(l,"zero",(function(){return Lu})),r.d(l,"str",(function(){return Nu})),r.d(l,"exactEquals",(function(){return Du})),r.d(l,"equals",(function(){return Cu})),r.d(l,"len",(function(){return Iu})),r.d(l,"sub",(function(){return Ou})),r.d(l,"mul",(function(){return Vu})),r.d(l,"div",(function(){return ju})),r.d(l,"dist",(function(){return qu})),r.d(l,"sqrDist",(function(){return ku})),r.d(l,"sqrLen",(function(){return zu})),r.d(l,"forEach",(function(){return Hu}));var d=1e-6,v="undefined"!=typeof Float32Array?Float32Array:Array,m=Math.random;function p(t){v=t}var M=Math.PI/180;function g(t){return t*M}function b(t,n){return Math.abs(t-n)<=d*Math.max(1,Math.abs(t),Math.abs(n))}function y(){var t=new v(4);return v!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function x(t){var n=new v(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function T(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function _(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function w(t,n,r,e){var i=new v(4);return i[0]=t,i[1]=n,i[2]=r,i[3]=e,i}function R(t,n,r,e,i){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t}function E(t,n){if(t===n){var r=n[1];t[1]=n[2],t[2]=r}else t[0]=n[0],t[1]=n[2],t[2]=n[1],t[3]=n[3];return t}function A(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=r*u-i*e;return o?(o=1/o,t[0]=u*o,t[1]=-e*o,t[2]=-i*o,t[3]=r*o,t):null}function S(t,n){var r=n[0];return t[0]=n[3],t[1]=-n[1],t[2]=-n[2],t[3]=r,t}function B(t){return t[0]*t[3]-t[2]*t[1]}function F(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*a+u*s,t[1]=i*a+o*s,t[2]=e*c+u*f,t[3]=i*c+o*f,t}function G(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=Math.sin(r),s=Math.cos(r);return t[0]=e*s+u*a,t[1]=i*s+o*a,t[2]=e*-a+u*s,t[3]=i*-a+o*s,t}function P(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=r[0],s=r[1];return t[0]=e*a,t[1]=i*a,t[2]=u*s,t[3]=o*s,t}function U(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t}function L(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t}function N(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function D(t){return Math.hypot(t[0],t[1],t[2],t[3])}function C(t,n,r,e){return t[2]=e[2]/e[0],r[0]=e[0],r[1]=e[1],r[3]=e[3]-t[2]*r[1],[t,n,r]}function I(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function O(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function V(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function j(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=n[0],a=n[1],s=n[2],c=n[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-a)<=d*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(u-c)<=d*Math.max(1,Math.abs(u),Math.abs(c))}function q(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function k(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}Math.hypot||(Math.hypot=function(){for(var t=0,n=arguments.length;n--;)t+=arguments[n]*arguments[n];return Math.sqrt(t)});var z=F,H=O;function X(){var t=new v(6);return v!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Y(t){var n=new v(6);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n}function W(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t}function K(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,n,r,e,i,u){var o=new v(6);return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o[4]=i,o[5]=u,o}function Z(t,n,r,e,i,u,o){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=u,t[5]=o,t}function J(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=r*u-e*i;return s?(s=1/s,t[0]=u*s,t[1]=-e*s,t[2]=-i*s,t[3]=r*s,t[4]=(i*a-u*o)*s,t[5]=(e*o-r*a)*s,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=r[0],f=r[1],h=r[2],l=r[3],d=r[4],v=r[5];return t[0]=e*c+u*f,t[1]=i*c+o*f,t[2]=e*h+u*l,t[3]=i*h+o*l,t[4]=e*d+u*v+a,t[5]=i*d+o*v+s,t}function nt(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=Math.sin(r),f=Math.cos(r);return t[0]=e*f+u*c,t[1]=i*f+o*c,t[2]=e*-c+u*f,t[3]=i*-c+o*f,t[4]=a,t[5]=s,t}function rt(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=r[0],f=r[1];return t[0]=e*c,t[1]=i*c,t[2]=u*f,t[3]=o*f,t[4]=a,t[5]=s,t}function et(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=r[0],f=r[1];return t[0]=e,t[1]=i,t[2]=u,t[3]=o,t[4]=e*c+u*f+a,t[5]=i*c+o*f+s,t}function it(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=-r,t[3]=e,t[4]=0,t[5]=0,t}function ut(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=n[1],t[4]=0,t[5]=0,t}function ot(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=n[0],t[5]=n[1],t}function at(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function st(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ct(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t}function ft(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t}function ht(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t}function lt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t}function dt(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]}function vt(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=t[4],a=t[5],s=n[0],c=n[1],f=n[2],h=n[3],l=n[4],v=n[5];return Math.abs(r-s)<=d*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(e-c)<=d*Math.max(1,Math.abs(e),Math.abs(c))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(u-h)<=d*Math.max(1,Math.abs(u),Math.abs(h))&&Math.abs(o-l)<=d*Math.max(1,Math.abs(o),Math.abs(l))&&Math.abs(a-v)<=d*Math.max(1,Math.abs(a),Math.abs(v))}var mt=tt,pt=ft;function Mt(){var t=new v(9);return v!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function gt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[4],t[4]=n[5],t[5]=n[6],t[6]=n[8],t[7]=n[9],t[8]=n[10],t}function bt(t){var n=new v(9);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function yt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function xt(t,n,r,e,i,u,o,a,s){var c=new v(9);return c[0]=t,c[1]=n,c[2]=r,c[3]=e,c[4]=i,c[5]=u,c[6]=o,c[7]=a,c[8]=s,c}function Tt(t,n,r,e,i,u,o,a,s,c){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=u,t[5]=o,t[6]=a,t[7]=s,t[8]=c,t}function _t(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function wt(t,n){if(t===n){var r=n[1],e=n[2],i=n[5];t[1]=n[3],t[2]=n[6],t[3]=r,t[5]=n[7],t[6]=e,t[7]=i}else t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8];return t}function Rt(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=n[6],c=n[7],f=n[8],h=f*o-a*c,l=-f*u+a*s,d=c*u-o*s,v=r*h+e*l+i*d;return v?(v=1/v,t[0]=h*v,t[1]=(-f*e+i*c)*v,t[2]=(a*e-i*o)*v,t[3]=l*v,t[4]=(f*r-i*s)*v,t[5]=(-a*r+i*u)*v,t[6]=d*v,t[7]=(-c*r+e*s)*v,t[8]=(o*r-e*u)*v,t):null}function Et(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=n[6],c=n[7],f=n[8];return t[0]=o*f-a*c,t[1]=i*c-e*f,t[2]=e*a-i*o,t[3]=a*s-u*f,t[4]=r*f-i*s,t[5]=i*u-r*a,t[6]=u*c-o*s,t[7]=e*s-r*c,t[8]=r*o-e*u,t}function At(t){var n=t[0],r=t[1],e=t[2],i=t[3],u=t[4],o=t[5],a=t[6],s=t[7],c=t[8];return n*(c*u-o*s)+r*(-c*i+o*a)+e*(s*i-u*a)}function St(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],l=r[0],d=r[1],v=r[2],m=r[3],p=r[4],M=r[5],g=r[6],b=r[7],y=r[8];return t[0]=l*e+d*o+v*c,t[1]=l*i+d*a+v*f,t[2]=l*u+d*s+v*h,t[3]=m*e+p*o+M*c,t[4]=m*i+p*a+M*f,t[5]=m*u+p*s+M*h,t[6]=g*e+b*o+y*c,t[7]=g*i+b*a+y*f,t[8]=g*u+b*s+y*h,t}function Bt(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],l=r[0],d=r[1];return t[0]=e,t[1]=i,t[2]=u,t[3]=o,t[4]=a,t[5]=s,t[6]=l*e+d*o+c,t[7]=l*i+d*a+f,t[8]=l*u+d*s+h,t}function Ft(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],l=Math.sin(r),d=Math.cos(r);return t[0]=d*e+l*o,t[1]=d*i+l*a,t[2]=d*u+l*s,t[3]=d*o-l*e,t[4]=d*a-l*i,t[5]=d*s-l*u,t[6]=c,t[7]=f,t[8]=h,t}function Gt(t,n,r){var e=r[0],i=r[1];return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=i*n[3],t[4]=i*n[4],t[5]=i*n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function Pt(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=n[0],t[7]=n[1],t[8]=1,t}function Ut(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=-r,t[4]=e,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=n[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Nt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=0,t[3]=n[2],t[4]=n[3],t[5]=0,t[6]=n[4],t[7]=n[5],t[8]=1,t}function Dt(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=r+r,a=e+e,s=i+i,c=r*o,f=e*o,h=e*a,l=i*o,d=i*a,v=i*s,m=u*o,p=u*a,M=u*s;return t[0]=1-h-v,t[3]=f-M,t[6]=l+p,t[1]=f+M,t[4]=1-c-v,t[7]=d-m,t[2]=l-p,t[5]=d+m,t[8]=1-c-h,t}function Ct(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=n[6],c=n[7],f=n[8],h=n[9],l=n[10],d=n[11],v=n[12],m=n[13],p=n[14],M=n[15],g=r*a-e*o,b=r*s-i*o,y=r*c-u*o,x=e*s-i*a,T=e*c-u*a,_=i*c-u*s,w=f*m-h*v,R=f*p-l*v,E=f*M-d*v,A=h*p-l*m,S=h*M-d*m,B=l*M-d*p,F=g*B-b*S+y*A+x*E-T*R+_*w;return F?(F=1/F,t[0]=(a*B-s*S+c*A)*F,t[1]=(s*E-o*B-c*R)*F,t[2]=(o*S-a*E+c*w)*F,t[3]=(i*S-e*B-u*A)*F,t[4]=(r*B-i*E+u*R)*F,t[5]=(e*E-r*S-u*w)*F,t[6]=(m*_-p*T+M*x)*F,t[7]=(p*y-v*_-M*b)*F,t[8]=(v*T-m*y+M*g)*F,t):null}function It(t,n,r){return t[0]=2/n,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function Ot(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function Vt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function jt(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t}function qt(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t}function kt(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t}function zt(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t}function Ht(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]}function Xt(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=t[4],a=t[5],s=t[6],c=t[7],f=t[8],h=n[0],l=n[1],v=n[2],m=n[3],p=n[4],M=n[5],g=n[6],b=n[7],y=n[8];return Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(e-l)<=d*Math.max(1,Math.abs(e),Math.abs(l))&&Math.abs(i-v)<=d*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(u-m)<=d*Math.max(1,Math.abs(u),Math.abs(m))&&Math.abs(o-p)<=d*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(a-M)<=d*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-g)<=d*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(c-b)<=d*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(f-y)<=d*Math.max(1,Math.abs(f),Math.abs(y))}var Yt=St,Wt=qt;function Kt(){var t=new v(16);return v!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Qt(t){var n=new v(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Zt(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Jt(t,n,r,e,i,u,o,a,s,c,f,h,l,d,m,p){var M=new v(16);return M[0]=t,M[1]=n,M[2]=r,M[3]=e,M[4]=i,M[5]=u,M[6]=o,M[7]=a,M[8]=s,M[9]=c,M[10]=f,M[11]=h,M[12]=l,M[13]=d,M[14]=m,M[15]=p,M}function $t(t,n,r,e,i,u,o,a,s,c,f,h,l,d,v,m,p){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=u,t[5]=o,t[6]=a,t[7]=s,t[8]=c,t[9]=f,t[10]=h,t[11]=l,t[12]=d,t[13]=v,t[14]=m,t[15]=p,t}function tn(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function nn(t,n){if(t===n){var r=n[1],e=n[2],i=n[3],u=n[6],o=n[7],a=n[11];t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=r,t[6]=n[9],t[7]=n[13],t[8]=e,t[9]=u,t[11]=n[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=n[0],t[1]=n[4],t[2]=n[8],t[3]=n[12],t[4]=n[1],t[5]=n[5],t[6]=n[9],t[7]=n[13],t[8]=n[2],t[9]=n[6],t[10]=n[10],t[11]=n[14],t[12]=n[3],t[13]=n[7],t[14]=n[11],t[15]=n[15];return t}function rn(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=n[6],c=n[7],f=n[8],h=n[9],l=n[10],d=n[11],v=n[12],m=n[13],p=n[14],M=n[15],g=r*a-e*o,b=r*s-i*o,y=r*c-u*o,x=e*s-i*a,T=e*c-u*a,_=i*c-u*s,w=f*m-h*v,R=f*p-l*v,E=f*M-d*v,A=h*p-l*m,S=h*M-d*m,B=l*M-d*p,F=g*B-b*S+y*A+x*E-T*R+_*w;return F?(F=1/F,t[0]=(a*B-s*S+c*A)*F,t[1]=(i*S-e*B-u*A)*F,t[2]=(m*_-p*T+M*x)*F,t[3]=(l*T-h*_-d*x)*F,t[4]=(s*E-o*B-c*R)*F,t[5]=(r*B-i*E+u*R)*F,t[6]=(p*y-v*_-M*b)*F,t[7]=(f*_-l*y+d*b)*F,t[8]=(o*S-a*E+c*w)*F,t[9]=(e*E-r*S-u*w)*F,t[10]=(v*T-m*y+M*g)*F,t[11]=(h*y-f*T-d*g)*F,t[12]=(a*R-o*A-s*w)*F,t[13]=(r*A-e*R+i*w)*F,t[14]=(m*b-v*x-p*g)*F,t[15]=(f*x-h*b+l*g)*F,t):null}function en(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=n[4],a=n[5],s=n[6],c=n[7],f=n[8],h=n[9],l=n[10],d=n[11],v=n[12],m=n[13],p=n[14],M=n[15];return t[0]=a*(l*M-d*p)-h*(s*M-c*p)+m*(s*d-c*l),t[1]=-(e*(l*M-d*p)-h*(i*M-u*p)+m*(i*d-u*l)),t[2]=e*(s*M-c*p)-a*(i*M-u*p)+m*(i*c-u*s),t[3]=-(e*(s*d-c*l)-a*(i*d-u*l)+h*(i*c-u*s)),t[4]=-(o*(l*M-d*p)-f*(s*M-c*p)+v*(s*d-c*l)),t[5]=r*(l*M-d*p)-f*(i*M-u*p)+v*(i*d-u*l),t[6]=-(r*(s*M-c*p)-o*(i*M-u*p)+v*(i*c-u*s)),t[7]=r*(s*d-c*l)-o*(i*d-u*l)+f*(i*c-u*s),t[8]=o*(h*M-d*m)-f*(a*M-c*m)+v*(a*d-c*h),t[9]=-(r*(h*M-d*m)-f*(e*M-u*m)+v*(e*d-u*h)),t[10]=r*(a*M-c*m)-o*(e*M-u*m)+v*(e*c-u*a),t[11]=-(r*(a*d-c*h)-o*(e*d-u*h)+f*(e*c-u*a)),t[12]=-(o*(h*p-l*m)-f*(a*p-s*m)+v*(a*l-s*h)),t[13]=r*(h*p-l*m)-f*(e*p-i*m)+v*(e*l-i*h),t[14]=-(r*(a*p-s*m)-o*(e*p-i*m)+v*(e*s-i*a)),t[15]=r*(a*l-s*h)-o*(e*l-i*h)+f*(e*s-i*a),t}function un(t){var n=t[0],r=t[1],e=t[2],i=t[3],u=t[4],o=t[5],a=t[6],s=t[7],c=t[8],f=t[9],h=t[10],l=t[11],d=t[12],v=t[13],m=t[14],p=t[15];return(n*o-r*u)*(h*p-l*m)-(n*a-e*u)*(f*p-l*v)+(n*s-i*u)*(f*m-h*v)+(r*a-e*o)*(c*p-l*d)-(r*s-i*o)*(c*m-h*d)+(e*s-i*a)*(c*v-f*d)}function on(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],l=n[9],d=n[10],v=n[11],m=n[12],p=n[13],M=n[14],g=n[15],b=r[0],y=r[1],x=r[2],T=r[3];return t[0]=b*e+y*a+x*h+T*m,t[1]=b*i+y*s+x*l+T*p,t[2]=b*u+y*c+x*d+T*M,t[3]=b*o+y*f+x*v+T*g,b=r[4],y=r[5],x=r[6],T=r[7],t[4]=b*e+y*a+x*h+T*m,t[5]=b*i+y*s+x*l+T*p,t[6]=b*u+y*c+x*d+T*M,t[7]=b*o+y*f+x*v+T*g,b=r[8],y=r[9],x=r[10],T=r[11],t[8]=b*e+y*a+x*h+T*m,t[9]=b*i+y*s+x*l+T*p,t[10]=b*u+y*c+x*d+T*M,t[11]=b*o+y*f+x*v+T*g,b=r[12],y=r[13],x=r[14],T=r[15],t[12]=b*e+y*a+x*h+T*m,t[13]=b*i+y*s+x*l+T*p,t[14]=b*u+y*c+x*d+T*M,t[15]=b*o+y*f+x*v+T*g,t}function an(t,n,r){var e,i,u,o,a,s,c,f,h,l,d,v,m=r[0],p=r[1],M=r[2];return n===t?(t[12]=n[0]*m+n[4]*p+n[8]*M+n[12],t[13]=n[1]*m+n[5]*p+n[9]*M+n[13],t[14]=n[2]*m+n[6]*p+n[10]*M+n[14],t[15]=n[3]*m+n[7]*p+n[11]*M+n[15]):(e=n[0],i=n[1],u=n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=n[8],l=n[9],d=n[10],v=n[11],t[0]=e,t[1]=i,t[2]=u,t[3]=o,t[4]=a,t[5]=s,t[6]=c,t[7]=f,t[8]=h,t[9]=l,t[10]=d,t[11]=v,t[12]=e*m+a*p+h*M+n[12],t[13]=i*m+s*p+l*M+n[13],t[14]=u*m+c*p+d*M+n[14],t[15]=o*m+f*p+v*M+n[15]),t}function sn(t,n,r){var e=r[0],i=r[1],u=r[2];return t[0]=n[0]*e,t[1]=n[1]*e,t[2]=n[2]*e,t[3]=n[3]*e,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=n[7]*i,t[8]=n[8]*u,t[9]=n[9]*u,t[10]=n[10]*u,t[11]=n[11]*u,t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function cn(t,n,r,e){var i,u,o,a,s,c,f,h,l,v,m,p,M,g,b,y,x,T,_,w,R,E,A,S,B=e[0],F=e[1],G=e[2],P=Math.hypot(B,F,G);return P<d?null:(B*=P=1/P,F*=P,G*=P,i=Math.sin(r),o=1-(u=Math.cos(r)),a=n[0],s=n[1],c=n[2],f=n[3],h=n[4],l=n[5],v=n[6],m=n[7],p=n[8],M=n[9],g=n[10],b=n[11],y=B*B*o+u,x=F*B*o+G*i,T=G*B*o-F*i,_=B*F*o-G*i,w=F*F*o+u,R=G*F*o+B*i,E=B*G*o+F*i,A=F*G*o-B*i,S=G*G*o+u,t[0]=a*y+h*x+p*T,t[1]=s*y+l*x+M*T,t[2]=c*y+v*x+g*T,t[3]=f*y+m*x+b*T,t[4]=a*_+h*w+p*R,t[5]=s*_+l*w+M*R,t[6]=c*_+v*w+g*R,t[7]=f*_+m*w+b*R,t[8]=a*E+h*A+p*S,t[9]=s*E+l*A+M*S,t[10]=c*E+v*A+g*S,t[11]=f*E+m*A+b*S,n!==t&&(t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t)}function fn(t,n,r){var e=Math.sin(r),i=Math.cos(r),u=n[4],o=n[5],a=n[6],s=n[7],c=n[8],f=n[9],h=n[10],l=n[11];return n!==t&&(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[4]=u*i+c*e,t[5]=o*i+f*e,t[6]=a*i+h*e,t[7]=s*i+l*e,t[8]=c*i-u*e,t[9]=f*i-o*e,t[10]=h*i-a*e,t[11]=l*i-s*e,t}function hn(t,n,r){var e=Math.sin(r),i=Math.cos(r),u=n[0],o=n[1],a=n[2],s=n[3],c=n[8],f=n[9],h=n[10],l=n[11];return n!==t&&(t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*i-c*e,t[1]=o*i-f*e,t[2]=a*i-h*e,t[3]=s*i-l*e,t[8]=u*e+c*i,t[9]=o*e+f*i,t[10]=a*e+h*i,t[11]=s*e+l*i,t}function ln(t,n,r){var e=Math.sin(r),i=Math.cos(r),u=n[0],o=n[1],a=n[2],s=n[3],c=n[4],f=n[5],h=n[6],l=n[7];return n!==t&&(t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15]),t[0]=u*i+c*e,t[1]=o*i+f*e,t[2]=a*i+h*e,t[3]=s*i+l*e,t[4]=c*i-u*e,t[5]=f*i-o*e,t[6]=h*i-a*e,t[7]=l*i-s*e,t}function dn(t,n){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function vn(t,n){return t[0]=n[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=n[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function mn(t,n,r){var e,i,u,o=r[0],a=r[1],s=r[2],c=Math.hypot(o,a,s);return c<d?null:(o*=c=1/c,a*=c,s*=c,e=Math.sin(n),u=1-(i=Math.cos(n)),t[0]=o*o*u+i,t[1]=a*o*u+s*e,t[2]=s*o*u-a*e,t[3]=0,t[4]=o*a*u-s*e,t[5]=a*a*u+i,t[6]=s*a*u+o*e,t[7]=0,t[8]=o*s*u+a*e,t[9]=a*s*u-o*e,t[10]=s*s*u+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Mn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=e,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function gn(t,n){var r=Math.sin(n),e=Math.cos(n);return t[0]=e,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=e,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function bn(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=e+e,s=i+i,c=u+u,f=e*a,h=e*s,l=e*c,d=i*s,v=i*c,m=u*c,p=o*a,M=o*s,g=o*c;return t[0]=1-(d+m),t[1]=h+g,t[2]=l-M,t[3]=0,t[4]=h-g,t[5]=1-(f+m),t[6]=v+p,t[7]=0,t[8]=l+M,t[9]=v-p,t[10]=1-(f+d),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function yn(t,n){var r=new v(3),e=-n[0],i=-n[1],u=-n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=e*e+i*i+u*u+o*o;return h>0?(r[0]=2*(a*o+f*e+s*u-c*i)/h,r[1]=2*(s*o+f*i+c*e-a*u)/h,r[2]=2*(c*o+f*u+a*i-s*e)/h):(r[0]=2*(a*o+f*e+s*u-c*i),r[1]=2*(s*o+f*i+c*e-a*u),r[2]=2*(c*o+f*u+a*i-s*e)),bn(t,n,r),t}function xn(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function Tn(t,n){var r=n[0],e=n[1],i=n[2],u=n[4],o=n[5],a=n[6],s=n[8],c=n[9],f=n[10];return t[0]=Math.hypot(r,e,i),t[1]=Math.hypot(u,o,a),t[2]=Math.hypot(s,c,f),t}function _n(t,n){var r=new v(3);Tn(r,n);var e=1/r[0],i=1/r[1],u=1/r[2],o=n[0]*e,a=n[1]*i,s=n[2]*u,c=n[4]*e,f=n[5]*i,h=n[6]*u,l=n[8]*e,d=n[9]*i,m=n[10]*u,p=o+f+m,M=0;return p>0?(M=2*Math.sqrt(p+1),t[3]=.25*M,t[0]=(h-d)/M,t[1]=(l-s)/M,t[2]=(a-c)/M):o>f&&o>m?(M=2*Math.sqrt(1+o-f-m),t[3]=(h-d)/M,t[0]=.25*M,t[1]=(a+c)/M,t[2]=(l+s)/M):f>m?(M=2*Math.sqrt(1+f-o-m),t[3]=(l-s)/M,t[0]=(a+c)/M,t[1]=.25*M,t[2]=(h+d)/M):(M=2*Math.sqrt(1+m-o-f),t[3]=(a-c)/M,t[0]=(l+s)/M,t[1]=(h+d)/M,t[2]=.25*M),t}function wn(t,n,r,e){var i=n[0],u=n[1],o=n[2],a=n[3],s=i+i,c=u+u,f=o+o,h=i*s,l=i*c,d=i*f,v=u*c,m=u*f,p=o*f,M=a*s,g=a*c,b=a*f,y=e[0],x=e[1],T=e[2];return t[0]=(1-(v+p))*y,t[1]=(l+b)*y,t[2]=(d-g)*y,t[3]=0,t[4]=(l-b)*x,t[5]=(1-(h+p))*x,t[6]=(m+M)*x,t[7]=0,t[8]=(d+g)*T,t[9]=(m-M)*T,t[10]=(1-(h+v))*T,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Rn(t,n,r,e,i){var u=n[0],o=n[1],a=n[2],s=n[3],c=u+u,f=o+o,h=a+a,l=u*c,d=u*f,v=u*h,m=o*f,p=o*h,M=a*h,g=s*c,b=s*f,y=s*h,x=e[0],T=e[1],_=e[2],w=i[0],R=i[1],E=i[2],A=(1-(m+M))*x,S=(d+y)*x,B=(v-b)*x,F=(d-y)*T,G=(1-(l+M))*T,P=(p+g)*T,U=(v+b)*_,L=(p-g)*_,N=(1-(l+m))*_;return t[0]=A,t[1]=S,t[2]=B,t[3]=0,t[4]=F,t[5]=G,t[6]=P,t[7]=0,t[8]=U,t[9]=L,t[10]=N,t[11]=0,t[12]=r[0]+w-(A*w+F*R+U*E),t[13]=r[1]+R-(S*w+G*R+L*E),t[14]=r[2]+E-(B*w+P*R+N*E),t[15]=1,t}function En(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=r+r,a=e+e,s=i+i,c=r*o,f=e*o,h=e*a,l=i*o,d=i*a,v=i*s,m=u*o,p=u*a,M=u*s;return t[0]=1-h-v,t[1]=f+M,t[2]=l-p,t[3]=0,t[4]=f-M,t[5]=1-c-v,t[6]=d+m,t[7]=0,t[8]=l+p,t[9]=d-m,t[10]=1-c-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function An(t,n,r,e,i,u,o){var a=1/(r-n),s=1/(i-e),c=1/(u-o);return t[0]=2*u*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*u*s,t[6]=0,t[7]=0,t[8]=(r+n)*a,t[9]=(i+e)*s,t[10]=(o+u)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*u*2*c,t[15]=0,t}function Sn(t,n,r,e,i){var u,o=1/Math.tan(n/2);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(u=1/(e-i),t[10]=(i+e)*u,t[14]=2*i*e*u):(t[10]=-1,t[14]=-2*e),t}function Bn(t,n,r,e){var i=Math.tan(n.upDegrees*Math.PI/180),u=Math.tan(n.downDegrees*Math.PI/180),o=Math.tan(n.leftDegrees*Math.PI/180),a=Math.tan(n.rightDegrees*Math.PI/180),s=2/(o+a),c=2/(i+u);return t[0]=s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(o-a)*s*.5,t[9]=(i-u)*c*.5,t[10]=e/(r-e),t[11]=-1,t[12]=0,t[13]=0,t[14]=e*r/(r-e),t[15]=0,t}function Fn(t,n,r,e,i,u,o){var a=1/(n-r),s=1/(e-i),c=1/(u-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(n+r)*a,t[13]=(i+e)*s,t[14]=(o+u)*c,t[15]=1,t}function Gn(t,n,r,e){var i,u,o,a,s,c,f,h,l,v,m=n[0],p=n[1],M=n[2],g=e[0],b=e[1],y=e[2],x=r[0],T=r[1],_=r[2];return Math.abs(m-x)<d&&Math.abs(p-T)<d&&Math.abs(M-_)<d?tn(t):(f=m-x,h=p-T,l=M-_,i=b*(l*=v=1/Math.hypot(f,h,l))-y*(h*=v),u=y*(f*=v)-g*l,o=g*h-b*f,(v=Math.hypot(i,u,o))?(i*=v=1/v,u*=v,o*=v):(i=0,u=0,o=0),a=h*o-l*u,s=l*i-f*o,c=f*u-h*i,(v=Math.hypot(a,s,c))?(a*=v=1/v,s*=v,c*=v):(a=0,s=0,c=0),t[0]=i,t[1]=a,t[2]=f,t[3]=0,t[4]=u,t[5]=s,t[6]=h,t[7]=0,t[8]=o,t[9]=c,t[10]=l,t[11]=0,t[12]=-(i*m+u*p+o*M),t[13]=-(a*m+s*p+c*M),t[14]=-(f*m+h*p+l*M),t[15]=1,t)}function Pn(t,n,r,e){var i=n[0],u=n[1],o=n[2],a=e[0],s=e[1],c=e[2],f=i-r[0],h=u-r[1],l=o-r[2],d=f*f+h*h+l*l;d>0&&(f*=d=1/Math.sqrt(d),h*=d,l*=d);var v=s*l-c*h,m=c*f-a*l,p=a*h-s*f;return(d=v*v+m*m+p*p)>0&&(v*=d=1/Math.sqrt(d),m*=d,p*=d),t[0]=v,t[1]=m,t[2]=p,t[3]=0,t[4]=h*p-l*m,t[5]=l*v-f*p,t[6]=f*m-h*v,t[7]=0,t[8]=f,t[9]=h,t[10]=l,t[11]=0,t[12]=i,t[13]=u,t[14]=o,t[15]=1,t}function Un(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ln(t){return Math.hypot(t[0],t[1],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function Nn(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t[8]=n[8]+r[8],t[9]=n[9]+r[9],t[10]=n[10]+r[10],t[11]=n[11]+r[11],t[12]=n[12]+r[12],t[13]=n[13]+r[13],t[14]=n[14]+r[14],t[15]=n[15]+r[15],t}function Dn(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t[4]=n[4]-r[4],t[5]=n[5]-r[5],t[6]=n[6]-r[6],t[7]=n[7]-r[7],t[8]=n[8]-r[8],t[9]=n[9]-r[9],t[10]=n[10]-r[10],t[11]=n[11]-r[11],t[12]=n[12]-r[12],t[13]=n[13]-r[13],t[14]=n[14]-r[14],t[15]=n[15]-r[15],t}function Cn(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t[8]=n[8]*r,t[9]=n[9]*r,t[10]=n[10]*r,t[11]=n[11]*r,t[12]=n[12]*r,t[13]=n[13]*r,t[14]=n[14]*r,t[15]=n[15]*r,t}function In(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t[4]=n[4]+r[4]*e,t[5]=n[5]+r[5]*e,t[6]=n[6]+r[6]*e,t[7]=n[7]+r[7]*e,t[8]=n[8]+r[8]*e,t[9]=n[9]+r[9]*e,t[10]=n[10]+r[10]*e,t[11]=n[11]+r[11]*e,t[12]=n[12]+r[12]*e,t[13]=n[13]+r[13]*e,t[14]=n[14]+r[14]*e,t[15]=n[15]+r[15]*e,t}function On(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]&&t[8]===n[8]&&t[9]===n[9]&&t[10]===n[10]&&t[11]===n[11]&&t[12]===n[12]&&t[13]===n[13]&&t[14]===n[14]&&t[15]===n[15]}function Vn(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=t[4],a=t[5],s=t[6],c=t[7],f=t[8],h=t[9],l=t[10],v=t[11],m=t[12],p=t[13],M=t[14],g=t[15],b=n[0],y=n[1],x=n[2],T=n[3],_=n[4],w=n[5],R=n[6],E=n[7],A=n[8],S=n[9],B=n[10],F=n[11],G=n[12],P=n[13],U=n[14],L=n[15];return Math.abs(r-b)<=d*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(e-y)<=d*Math.max(1,Math.abs(e),Math.abs(y))&&Math.abs(i-x)<=d*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(u-T)<=d*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(o-_)<=d*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(a-w)<=d*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(s-R)<=d*Math.max(1,Math.abs(s),Math.abs(R))&&Math.abs(c-E)<=d*Math.max(1,Math.abs(c),Math.abs(E))&&Math.abs(f-A)<=d*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(h-S)<=d*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(l-B)<=d*Math.max(1,Math.abs(l),Math.abs(B))&&Math.abs(v-F)<=d*Math.max(1,Math.abs(v),Math.abs(F))&&Math.abs(m-G)<=d*Math.max(1,Math.abs(m),Math.abs(G))&&Math.abs(p-P)<=d*Math.max(1,Math.abs(p),Math.abs(P))&&Math.abs(M-U)<=d*Math.max(1,Math.abs(M),Math.abs(U))&&Math.abs(g-L)<=d*Math.max(1,Math.abs(g),Math.abs(L))}var jn=on,qn=Dn;function kn(){var t=new v(3);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function zn(t){var n=new v(3);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n}function Hn(t){var n=t[0],r=t[1],e=t[2];return Math.hypot(n,r,e)}function Xn(t,n,r){var e=new v(3);return e[0]=t,e[1]=n,e[2]=r,e}function Yn(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function Wn(t,n,r,e){return t[0]=n,t[1]=r,t[2]=e,t}function Kn(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t}function Qn(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t}function Zn(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t}function Jn(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t}function $n(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t}function tr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t}function nr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t}function rr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t}function er(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t}function ir(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function ur(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t}function or(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return Math.hypot(r,e,i)}function ar(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2];return r*r+e*e+i*i}function sr(t){var n=t[0],r=t[1],e=t[2];return n*n+r*r+e*e}function cr(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function fr(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t}function hr(t,n){var r=n[0],e=n[1],i=n[2],u=r*r+e*e+i*i;return u>0&&(u=1/Math.sqrt(u)),t[0]=n[0]*u,t[1]=n[1]*u,t[2]=n[2]*u,t}function lr(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]}function dr(t,n,r){var e=n[0],i=n[1],u=n[2],o=r[0],a=r[1],s=r[2];return t[0]=i*s-u*a,t[1]=u*o-e*s,t[2]=e*a-i*o,t}function vr(t,n,r,e){var i=n[0],u=n[1],o=n[2];return t[0]=i+e*(r[0]-i),t[1]=u+e*(r[1]-u),t[2]=o+e*(r[2]-o),t}function mr(t,n,r,e,i,u){var o=u*u,a=o*(2*u-3)+1,s=o*(u-2)+u,c=o*(u-1),f=o*(3-2*u);return t[0]=n[0]*a+r[0]*s+e[0]*c+i[0]*f,t[1]=n[1]*a+r[1]*s+e[1]*c+i[1]*f,t[2]=n[2]*a+r[2]*s+e[2]*c+i[2]*f,t}function pr(t,n,r,e,i,u){var o=1-u,a=o*o,s=u*u,c=a*o,f=3*u*a,h=3*s*o,l=s*u;return t[0]=n[0]*c+r[0]*f+e[0]*h+i[0]*l,t[1]=n[1]*c+r[1]*f+e[1]*h+i[1]*l,t[2]=n[2]*c+r[2]*f+e[2]*h+i[2]*l,t}function Mr(t,n){n=n||1;var r=2*m()*Math.PI,e=2*m()-1,i=Math.sqrt(1-e*e)*n;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=e*n,t}function gr(t,n,r){var e=n[0],i=n[1],u=n[2],o=r[3]*e+r[7]*i+r[11]*u+r[15];return o=o||1,t[0]=(r[0]*e+r[4]*i+r[8]*u+r[12])/o,t[1]=(r[1]*e+r[5]*i+r[9]*u+r[13])/o,t[2]=(r[2]*e+r[6]*i+r[10]*u+r[14])/o,t}function br(t,n,r){var e=n[0],i=n[1],u=n[2];return t[0]=e*r[0]+i*r[3]+u*r[6],t[1]=e*r[1]+i*r[4]+u*r[7],t[2]=e*r[2]+i*r[5]+u*r[8],t}function yr(t,n,r){var e=r[0],i=r[1],u=r[2],o=r[3],a=n[0],s=n[1],c=n[2],f=i*c-u*s,h=u*a-e*c,l=e*s-i*a,d=i*l-u*h,v=u*f-e*l,m=e*h-i*f,p=2*o;return f*=p,h*=p,l*=p,d*=2,v*=2,m*=2,t[0]=a+f+d,t[1]=s+h+v,t[2]=c+l+m,t}function xr(t,n,r,e){var i=[],u=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],u[0]=i[0],u[1]=i[1]*Math.cos(e)-i[2]*Math.sin(e),u[2]=i[1]*Math.sin(e)+i[2]*Math.cos(e),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function Tr(t,n,r,e){var i=[],u=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],u[0]=i[2]*Math.sin(e)+i[0]*Math.cos(e),u[1]=i[1],u[2]=i[2]*Math.cos(e)-i[0]*Math.sin(e),t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function _r(t,n,r,e){var i=[],u=[];return i[0]=n[0]-r[0],i[1]=n[1]-r[1],i[2]=n[2]-r[2],u[0]=i[0]*Math.cos(e)-i[1]*Math.sin(e),u[1]=i[0]*Math.sin(e)+i[1]*Math.cos(e),u[2]=i[2],t[0]=u[0]+r[0],t[1]=u[1]+r[1],t[2]=u[2]+r[2],t}function wr(t,n){var r=Xn(t[0],t[1],t[2]),e=Xn(n[0],n[1],n[2]);hr(r,r),hr(e,e);var i=lr(r,e);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Rr(t){return t[0]=0,t[1]=0,t[2]=0,t}function Er(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Ar(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]}function Sr(t,n){var r=t[0],e=t[1],i=t[2],u=n[0],o=n[1],a=n[2];return Math.abs(r-u)<=d*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(e-o)<=d*Math.max(1,Math.abs(e),Math.abs(o))&&Math.abs(i-a)<=d*Math.max(1,Math.abs(i),Math.abs(a))}var Br,Fr=Qn,Gr=Zn,Pr=Jn,Ur=or,Lr=ar,Nr=Hn,Dr=sr,Cr=(Br=kn(),function(t,n,r,e,i,u){var o,a;for(n||(n=3),r||(r=0),a=e?Math.min(e*n+r,t.length):t.length,o=r;o<a;o+=n)Br[0]=t[o],Br[1]=t[o+1],Br[2]=t[o+2],i(Br,Br,u),t[o]=Br[0],t[o+1]=Br[1],t[o+2]=Br[2];return t});function Ir(){var t=new v(4);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Or(t){var n=new v(4);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n}function Vr(t,n,r,e){var i=new v(4);return i[0]=t,i[1]=n,i[2]=r,i[3]=e,i}function jr(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t}function qr(t,n,r,e,i){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t}function kr(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t}function zr(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t[2]=n[2]-r[2],t[3]=n[3]-r[3],t}function Hr(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t[2]=n[2]*r[2],t[3]=n[3]*r[3],t}function Xr(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t[2]=n[2]/r[2],t[3]=n[3]/r[3],t}function Yr(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t[2]=Math.ceil(n[2]),t[3]=Math.ceil(n[3]),t}function Wr(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t[2]=Math.floor(n[2]),t[3]=Math.floor(n[3]),t}function Kr(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t[2]=Math.min(n[2],r[2]),t[3]=Math.min(n[3],r[3]),t}function Qr(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t[2]=Math.max(n[2],r[2]),t[3]=Math.max(n[3],r[3]),t}function Zr(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t[2]=Math.round(n[2]),t[3]=Math.round(n[3]),t}function Jr(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t}function $r(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t[2]=n[2]+r[2]*e,t[3]=n[3]+r[3]*e,t}function te(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],u=n[3]-t[3];return Math.hypot(r,e,i,u)}function ne(t,n){var r=n[0]-t[0],e=n[1]-t[1],i=n[2]-t[2],u=n[3]-t[3];return r*r+e*e+i*i+u*u}function re(t){var n=t[0],r=t[1],e=t[2],i=t[3];return Math.hypot(n,r,e,i)}function ee(t){var n=t[0],r=t[1],e=t[2],i=t[3];return n*n+r*r+e*e+i*i}function ie(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=-n[3],t}function ue(t,n){return t[0]=1/n[0],t[1]=1/n[1],t[2]=1/n[2],t[3]=1/n[3],t}function oe(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=r*r+e*e+i*i+u*u;return o>0&&(o=1/Math.sqrt(o)),t[0]=r*o,t[1]=e*o,t[2]=i*o,t[3]=u*o,t}function ae(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]+t[3]*n[3]}function se(t,n,r,e){var i=r[0]*e[1]-r[1]*e[0],u=r[0]*e[2]-r[2]*e[0],o=r[0]*e[3]-r[3]*e[0],a=r[1]*e[2]-r[2]*e[1],s=r[1]*e[3]-r[3]*e[1],c=r[2]*e[3]-r[3]*e[2],f=n[0],h=n[1],l=n[2],d=n[3];return t[0]=h*c-l*s+d*a,t[1]=-f*c+l*o-d*u,t[2]=f*s-h*o+d*i,t[3]=-f*a+h*u-l*i,t}function ce(t,n,r,e){var i=n[0],u=n[1],o=n[2],a=n[3];return t[0]=i+e*(r[0]-i),t[1]=u+e*(r[1]-u),t[2]=o+e*(r[2]-o),t[3]=a+e*(r[3]-a),t}function fe(t,n){var r,e,i,u,o,a;n=n||1;do{o=(r=2*m()-1)*r+(e=2*m()-1)*e}while(o>=1);do{a=(i=2*m()-1)*i+(u=2*m()-1)*u}while(a>=1);var s=Math.sqrt((1-o)/a);return t[0]=n*r,t[1]=n*e,t[2]=n*i*s,t[3]=n*u*s,t}function he(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3];return t[0]=r[0]*e+r[4]*i+r[8]*u+r[12]*o,t[1]=r[1]*e+r[5]*i+r[9]*u+r[13]*o,t[2]=r[2]*e+r[6]*i+r[10]*u+r[14]*o,t[3]=r[3]*e+r[7]*i+r[11]*u+r[15]*o,t}function le(t,n,r){var e=n[0],i=n[1],u=n[2],o=r[0],a=r[1],s=r[2],c=r[3],f=c*e+a*u-s*i,h=c*i+s*e-o*u,l=c*u+o*i-a*e,d=-o*e-a*i-s*u;return t[0]=f*c+d*-o+h*-s-l*-a,t[1]=h*c+d*-a+l*-o-f*-s,t[2]=l*c+d*-s+f*-a-h*-o,t[3]=n[3],t}function de(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function ve(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function me(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]}function pe(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=n[0],a=n[1],s=n[2],c=n[3];return Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(e-a)<=d*Math.max(1,Math.abs(e),Math.abs(a))&&Math.abs(i-s)<=d*Math.max(1,Math.abs(i),Math.abs(s))&&Math.abs(u-c)<=d*Math.max(1,Math.abs(u),Math.abs(c))}var Me=zr,ge=Hr,be=Xr,ye=te,xe=ne,Te=re,_e=ee,we=function(){var t=Ir();return function(n,r,e,i,u,o){var a,s;for(r||(r=4),e||(e=0),s=i?Math.min(i*r+e,n.length):n.length,a=e;a<s;a+=r)t[0]=n[a],t[1]=n[a+1],t[2]=n[a+2],t[3]=n[a+3],u(t,t,o),n[a]=t[0],n[a+1]=t[1],n[a+2]=t[2],n[a+3]=t[3];return n}}();function Re(){var t=new v(4);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Ee(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Ae(t,n,r){r*=.5;var e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function Se(t,n){var r=2*Math.acos(n[3]),e=Math.sin(r/2);return e>d?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function Be(t,n){var r=ii(t,n);return Math.acos(2*r*r-1)}function Fe(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*f+o*a+i*c-u*s,t[1]=i*f+o*s+u*a-e*c,t[2]=u*f+o*c+e*s-i*a,t[3]=o*f-e*a-i*s-u*c,t}function Ge(t,n,r){r*=.5;var e=n[0],i=n[1],u=n[2],o=n[3],a=Math.sin(r),s=Math.cos(r);return t[0]=e*s+o*a,t[1]=i*s+u*a,t[2]=u*s-i*a,t[3]=o*s-e*a,t}function Pe(t,n,r){r*=.5;var e=n[0],i=n[1],u=n[2],o=n[3],a=Math.sin(r),s=Math.cos(r);return t[0]=e*s-u*a,t[1]=i*s+o*a,t[2]=u*s+e*a,t[3]=o*s-i*a,t}function Ue(t,n,r){r*=.5;var e=n[0],i=n[1],u=n[2],o=n[3],a=Math.sin(r),s=Math.cos(r);return t[0]=e*s+i*a,t[1]=i*s-e*a,t[2]=u*s+o*a,t[3]=o*s-u*a,t}function Le(t,n){var r=n[0],e=n[1],i=n[2];return t[0]=r,t[1]=e,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-i*i)),t}function Ne(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=Math.sqrt(r*r+e*e+i*i),a=Math.exp(u),s=o>0?a*Math.sin(o)/o:0;return t[0]=r*s,t[1]=e*s,t[2]=i*s,t[3]=a*Math.cos(o),t}function De(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=Math.sqrt(r*r+e*e+i*i),a=o>0?Math.atan2(o,u)/o:0;return t[0]=r*a,t[1]=e*a,t[2]=i*a,t[3]=.5*Math.log(r*r+e*e+i*i+u*u),t}function Ce(t,n,r){return De(t,n),ei(t,t,r),Ne(t,t),t}function Ie(t,n,r,e){var i,u,o,a,s,c=n[0],f=n[1],h=n[2],l=n[3],v=r[0],m=r[1],p=r[2],M=r[3];return(u=c*v+f*m+h*p+l*M)<0&&(u=-u,v=-v,m=-m,p=-p,M=-M),1-u>d?(i=Math.acos(u),o=Math.sin(i),a=Math.sin((1-e)*i)/o,s=Math.sin(e*i)/o):(a=1-e,s=e),t[0]=a*c+s*v,t[1]=a*f+s*m,t[2]=a*h+s*p,t[3]=a*l+s*M,t}function Oe(t){var n=m(),r=m(),e=m(),i=Math.sqrt(1-n),u=Math.sqrt(n);return t[0]=i*Math.sin(2*Math.PI*r),t[1]=i*Math.cos(2*Math.PI*r),t[2]=u*Math.sin(2*Math.PI*e),t[3]=u*Math.cos(2*Math.PI*e),t}function Ve(t,n){var r=n[0],e=n[1],i=n[2],u=n[3],o=r*r+e*e+i*i+u*u,a=o?1/o:0;return t[0]=-r*a,t[1]=-e*a,t[2]=-i*a,t[3]=u*a,t}function je(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function qe(t,n){var r,e=n[0]+n[4]+n[8];if(e>0)r=Math.sqrt(e+1),t[3]=.5*r,r=.5/r,t[0]=(n[5]-n[7])*r,t[1]=(n[6]-n[2])*r,t[2]=(n[1]-n[3])*r;else{var i=0;n[4]>n[0]&&(i=1),n[8]>n[3*i+i]&&(i=2);var u=(i+1)%3,o=(i+2)%3;r=Math.sqrt(n[3*i+i]-n[3*u+u]-n[3*o+o]+1),t[i]=.5*r,r=.5/r,t[3]=(n[3*u+o]-n[3*o+u])*r,t[u]=(n[3*u+i]+n[3*i+u])*r,t[o]=(n[3*o+i]+n[3*i+o])*r}return t}function ke(t,n,r,e){var i=.5*Math.PI/180;n*=i,r*=i,e*=i;var u=Math.sin(n),o=Math.cos(n),a=Math.sin(r),s=Math.cos(r),c=Math.sin(e),f=Math.cos(e);return t[0]=u*s*f-o*a*c,t[1]=o*a*f+u*s*c,t[2]=o*s*c-u*a*f,t[3]=o*s*f+u*a*c,t}function ze(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var He,Xe,Ye,We,Ke,Qe,Ze=Or,Je=Vr,$e=jr,ti=qr,ni=kr,ri=Fe,ei=Jr,ii=ae,ui=ce,oi=re,ai=oi,si=ee,ci=si,fi=oe,hi=me,li=pe,di=(He=kn(),Xe=Xn(1,0,0),Ye=Xn(0,1,0),function(t,n,r){var e=lr(n,r);return e<-.999999?(dr(He,Xe,n),Nr(He)<1e-6&&dr(He,Ye,n),hr(He,He),Ae(t,He,Math.PI),t):e>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(dr(He,n,r),t[0]=He[0],t[1]=He[1],t[2]=He[2],t[3]=1+e,fi(t,t))}),vi=(We=Re(),Ke=Re(),function(t,n,r,e,i,u){return Ie(We,n,i,u),Ie(Ke,r,e,u),Ie(t,We,Ke,2*u*(1-u)),t}),mi=(Qe=Mt(),function(t,n,r,e){return Qe[0]=r[0],Qe[3]=r[1],Qe[6]=r[2],Qe[1]=e[0],Qe[4]=e[1],Qe[7]=e[2],Qe[2]=-n[0],Qe[5]=-n[1],Qe[8]=-n[2],fi(t,qe(t,Qe))});function pi(){var t=new v(8);return v!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function Mi(t){var n=new v(8);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n}function gi(t,n,r,e,i,u,o,a){var s=new v(8);return s[0]=t,s[1]=n,s[2]=r,s[3]=e,s[4]=i,s[5]=u,s[6]=o,s[7]=a,s}function bi(t,n,r,e,i,u,o){var a=new v(8);a[0]=t,a[1]=n,a[2]=r,a[3]=e;var s=.5*i,c=.5*u,f=.5*o;return a[4]=s*e+c*r-f*n,a[5]=c*e+f*t-s*r,a[6]=f*e+s*n-c*t,a[7]=-s*t-c*n-f*r,a}function yi(t,n,r){var e=.5*r[0],i=.5*r[1],u=.5*r[2],o=n[0],a=n[1],s=n[2],c=n[3];return t[0]=o,t[1]=a,t[2]=s,t[3]=c,t[4]=e*c+i*s-u*a,t[5]=i*c+u*o-e*s,t[6]=u*c+e*a-i*o,t[7]=-e*o-i*a-u*s,t}function xi(t,n){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*n[0],t[5]=.5*n[1],t[6]=.5*n[2],t[7]=0,t}function Ti(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function _i(t,n){var r=Re();_n(r,n);var e=new v(3);return xn(e,n),yi(t,r,e),t}function wi(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t}function Ri(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Ei(t,n,r,e,i,u,o,a,s){return t[0]=n,t[1]=r,t[2]=e,t[3]=i,t[4]=u,t[5]=o,t[6]=a,t[7]=s,t}var Ai=$e;function Si(t,n){return t[0]=n[4],t[1]=n[5],t[2]=n[6],t[3]=n[7],t}var Bi=$e;function Fi(t,n){return t[4]=n[0],t[5]=n[1],t[6]=n[2],t[7]=n[3],t}function Gi(t,n){var r=n[4],e=n[5],i=n[6],u=n[7],o=-n[0],a=-n[1],s=-n[2],c=n[3];return t[0]=2*(r*c+u*o+e*s-i*a),t[1]=2*(e*c+u*a+i*o-r*s),t[2]=2*(i*c+u*s+r*a-e*o),t}function Pi(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=.5*r[0],s=.5*r[1],c=.5*r[2],f=n[4],h=n[5],l=n[6],d=n[7];return t[0]=e,t[1]=i,t[2]=u,t[3]=o,t[4]=o*a+i*c-u*s+f,t[5]=o*s+u*a-e*c+h,t[6]=o*c+e*s-i*a+l,t[7]=-e*a-i*s-u*c+d,t}function Ui(t,n,r){var e=-n[0],i=-n[1],u=-n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=a*o+f*e+s*u-c*i,l=s*o+f*i+c*e-a*u,d=c*o+f*u+a*i-s*e,v=f*o-a*e-s*i-c*u;return Ge(t,n,r),e=t[0],i=t[1],u=t[2],o=t[3],t[4]=h*o+v*e+l*u-d*i,t[5]=l*o+v*i+d*e-h*u,t[6]=d*o+v*u+h*i-l*e,t[7]=v*o-h*e-l*i-d*u,t}function Li(t,n,r){var e=-n[0],i=-n[1],u=-n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=a*o+f*e+s*u-c*i,l=s*o+f*i+c*e-a*u,d=c*o+f*u+a*i-s*e,v=f*o-a*e-s*i-c*u;return Pe(t,n,r),e=t[0],i=t[1],u=t[2],o=t[3],t[4]=h*o+v*e+l*u-d*i,t[5]=l*o+v*i+d*e-h*u,t[6]=d*o+v*u+h*i-l*e,t[7]=v*o-h*e-l*i-d*u,t}function Ni(t,n,r){var e=-n[0],i=-n[1],u=-n[2],o=n[3],a=n[4],s=n[5],c=n[6],f=n[7],h=a*o+f*e+s*u-c*i,l=s*o+f*i+c*e-a*u,d=c*o+f*u+a*i-s*e,v=f*o-a*e-s*i-c*u;return Ue(t,n,r),e=t[0],i=t[1],u=t[2],o=t[3],t[4]=h*o+v*e+l*u-d*i,t[5]=l*o+v*i+d*e-h*u,t[6]=d*o+v*u+h*i-l*e,t[7]=v*o-h*e-l*i-d*u,t}function Di(t,n,r){var e=r[0],i=r[1],u=r[2],o=r[3],a=n[0],s=n[1],c=n[2],f=n[3];return t[0]=a*o+f*e+s*u-c*i,t[1]=s*o+f*i+c*e-a*u,t[2]=c*o+f*u+a*i-s*e,t[3]=f*o-a*e-s*i-c*u,a=n[4],s=n[5],c=n[6],f=n[7],t[4]=a*o+f*e+s*u-c*i,t[5]=s*o+f*i+c*e-a*u,t[6]=c*o+f*u+a*i-s*e,t[7]=f*o-a*e-s*i-c*u,t}function Ci(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=r[0],s=r[1],c=r[2],f=r[3];return t[0]=e*f+o*a+i*c-u*s,t[1]=i*f+o*s+u*a-e*c,t[2]=u*f+o*c+e*s-i*a,t[3]=o*f-e*a-i*s-u*c,a=r[4],s=r[5],c=r[6],f=r[7],t[4]=e*f+o*a+i*c-u*s,t[5]=i*f+o*s+u*a-e*c,t[6]=u*f+o*c+e*s-i*a,t[7]=o*f-e*a-i*s-u*c,t}function Ii(t,n,r,e){if(Math.abs(e)<d)return wi(t,n);var i=Math.hypot(r[0],r[1],r[2]);e*=.5;var u=Math.sin(e),o=u*r[0]/i,a=u*r[1]/i,s=u*r[2]/i,c=Math.cos(e),f=n[0],h=n[1],l=n[2],v=n[3];t[0]=f*c+v*o+h*s-l*a,t[1]=h*c+v*a+l*o-f*s,t[2]=l*c+v*s+f*a-h*o,t[3]=v*c-f*o-h*a-l*s;var m=n[4],p=n[5],M=n[6],g=n[7];return t[4]=m*c+g*o+p*s-M*a,t[5]=p*c+g*a+M*o-m*s,t[6]=M*c+g*s+m*a-p*o,t[7]=g*c-m*o-p*a-M*s,t}function Oi(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t[2]=n[2]+r[2],t[3]=n[3]+r[3],t[4]=n[4]+r[4],t[5]=n[5]+r[5],t[6]=n[6]+r[6],t[7]=n[7]+r[7],t}function Vi(t,n,r){var e=n[0],i=n[1],u=n[2],o=n[3],a=r[4],s=r[5],c=r[6],f=r[7],h=n[4],l=n[5],d=n[6],v=n[7],m=r[0],p=r[1],M=r[2],g=r[3];return t[0]=e*g+o*m+i*M-u*p,t[1]=i*g+o*p+u*m-e*M,t[2]=u*g+o*M+e*p-i*m,t[3]=o*g-e*m-i*p-u*M,t[4]=e*f+o*a+i*c-u*s+h*g+v*m+l*M-d*p,t[5]=i*f+o*s+u*a-e*c+l*g+v*p+d*m-h*M,t[6]=u*f+o*c+e*s-i*a+d*g+v*M+h*p-l*m,t[7]=o*f-e*a-i*s-u*c+v*g-h*m-l*p-d*M,t}var ji=Vi;function qi(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=n[3]*r,t[4]=n[4]*r,t[5]=n[5]*r,t[6]=n[6]*r,t[7]=n[7]*r,t}var ki=ii;function zi(t,n,r,e){var i=1-e;return ki(n,r)<0&&(e=-e),t[0]=n[0]*i+r[0]*e,t[1]=n[1]*i+r[1]*e,t[2]=n[2]*i+r[2]*e,t[3]=n[3]*i+r[3]*e,t[4]=n[4]*i+r[4]*e,t[5]=n[5]*i+r[5]*e,t[6]=n[6]*i+r[6]*e,t[7]=n[7]*i+r[7]*e,t}function Hi(t,n){var r=Ki(n);return t[0]=-n[0]/r,t[1]=-n[1]/r,t[2]=-n[2]/r,t[3]=n[3]/r,t[4]=-n[4]/r,t[5]=-n[5]/r,t[6]=-n[6]/r,t[7]=n[7]/r,t}function Xi(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t[4]=-n[4],t[5]=-n[5],t[6]=-n[6],t[7]=n[7],t}var Yi=oi,Wi=Yi,Ki=si,Qi=Ki;function Zi(t,n){var r=Ki(n);if(r>0){r=Math.sqrt(r);var e=n[0]/r,i=n[1]/r,u=n[2]/r,o=n[3]/r,a=n[4],s=n[5],c=n[6],f=n[7],h=e*a+i*s+u*c+o*f;t[0]=e,t[1]=i,t[2]=u,t[3]=o,t[4]=(a-e*h)/r,t[5]=(s-i*h)/r,t[6]=(c-u*h)/r,t[7]=(f-o*h)/r}return t}function Ji(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function $i(t,n){return t[0]===n[0]&&t[1]===n[1]&&t[2]===n[2]&&t[3]===n[3]&&t[4]===n[4]&&t[5]===n[5]&&t[6]===n[6]&&t[7]===n[7]}function tu(t,n){var r=t[0],e=t[1],i=t[2],u=t[3],o=t[4],a=t[5],s=t[6],c=t[7],f=n[0],h=n[1],l=n[2],v=n[3],m=n[4],p=n[5],M=n[6],g=n[7];return Math.abs(r-f)<=d*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(e-h)<=d*Math.max(1,Math.abs(e),Math.abs(h))&&Math.abs(i-l)<=d*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(u-v)<=d*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(o-m)<=d*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(a-p)<=d*Math.max(1,Math.abs(a),Math.abs(p))&&Math.abs(s-M)<=d*Math.max(1,Math.abs(s),Math.abs(M))&&Math.abs(c-g)<=d*Math.max(1,Math.abs(c),Math.abs(g))}function nu(){var t=new v(2);return v!=Float32Array&&(t[0]=0,t[1]=0),t}function ru(t){var n=new v(2);return n[0]=t[0],n[1]=t[1],n}function eu(t,n){var r=new v(2);return r[0]=t,r[1]=n,r}function iu(t,n){return t[0]=n[0],t[1]=n[1],t}function uu(t,n,r){return t[0]=n,t[1]=r,t}function ou(t,n,r){return t[0]=n[0]+r[0],t[1]=n[1]+r[1],t}function au(t,n,r){return t[0]=n[0]-r[0],t[1]=n[1]-r[1],t}function su(t,n,r){return t[0]=n[0]*r[0],t[1]=n[1]*r[1],t}function cu(t,n,r){return t[0]=n[0]/r[0],t[1]=n[1]/r[1],t}function fu(t,n){return t[0]=Math.ceil(n[0]),t[1]=Math.ceil(n[1]),t}function hu(t,n){return t[0]=Math.floor(n[0]),t[1]=Math.floor(n[1]),t}function lu(t,n,r){return t[0]=Math.min(n[0],r[0]),t[1]=Math.min(n[1],r[1]),t}function du(t,n,r){return t[0]=Math.max(n[0],r[0]),t[1]=Math.max(n[1],r[1]),t}function vu(t,n){return t[0]=Math.round(n[0]),t[1]=Math.round(n[1]),t}function mu(t,n,r){return t[0]=n[0]*r,t[1]=n[1]*r,t}function pu(t,n,r,e){return t[0]=n[0]+r[0]*e,t[1]=n[1]+r[1]*e,t}function Mu(t,n){var r=n[0]-t[0],e=n[1]-t[1];return Math.hypot(r,e)}function gu(t,n){var r=n[0]-t[0],e=n[1]-t[1];return r*r+e*e}function bu(t){var n=t[0],r=t[1];return Math.hypot(n,r)}function yu(t){var n=t[0],r=t[1];return n*n+r*r}function xu(t,n){return t[0]=-n[0],t[1]=-n[1],t}function Tu(t,n){return t[0]=1/n[0],t[1]=1/n[1],t}function _u(t,n){var r=n[0],e=n[1],i=r*r+e*e;return i>0&&(i=1/Math.sqrt(i)),t[0]=n[0]*i,t[1]=n[1]*i,t}function wu(t,n){return t[0]*n[0]+t[1]*n[1]}function Ru(t,n,r){var e=n[0]*r[1]-n[1]*r[0];return t[0]=t[1]=0,t[2]=e,t}function Eu(t,n,r,e){var i=n[0],u=n[1];return t[0]=i+e*(r[0]-i),t[1]=u+e*(r[1]-u),t}function Au(t,n){n=n||1;var r=2*m()*Math.PI;return t[0]=Math.cos(r)*n,t[1]=Math.sin(r)*n,t}function Su(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i,t[1]=r[1]*e+r[3]*i,t}function Bu(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[2]*i+r[4],t[1]=r[1]*e+r[3]*i+r[5],t}function Fu(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[3]*i+r[6],t[1]=r[1]*e+r[4]*i+r[7],t}function Gu(t,n,r){var e=n[0],i=n[1];return t[0]=r[0]*e+r[4]*i+r[12],t[1]=r[1]*e+r[5]*i+r[13],t}function Pu(t,n,r,e){var i=n[0]-r[0],u=n[1]-r[1],o=Math.sin(e),a=Math.cos(e);return t[0]=i*a-u*o+r[0],t[1]=i*o+u*a+r[1],t}function Uu(t,n){var r=t[0],e=t[1],i=n[0],u=n[1],o=r*r+e*e;o>0&&(o=1/Math.sqrt(o));var a=i*i+u*u;a>0&&(a=1/Math.sqrt(a));var s=(r*i+e*u)*o*a;return s>1?0:s<-1?Math.PI:Math.acos(s)}function Lu(t){return t[0]=0,t[1]=0,t}function Nu(t){return"vec2("+t[0]+", "+t[1]+")"}function Du(t,n){return t[0]===n[0]&&t[1]===n[1]}function Cu(t,n){var r=t[0],e=t[1],i=n[0],u=n[1];return Math.abs(r-i)<=d*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(e-u)<=d*Math.max(1,Math.abs(e),Math.abs(u))}var Iu=bu,Ou=au,Vu=su,ju=cu,qu=Mu,ku=gu,zu=yu,Hu=function(){var t=nu();return function(n,r,e,i,u,o){var a,s;for(r||(r=2),e||(e=0),s=i?Math.min(i*r+e,n.length):n.length,a=e;a<s;a+=r)t[0]=n[a],t[1]=n[a+1],u(t,t,o),n[a]=t[0],n[a+1]=t[1];return n}}();r.d(n,"glMatrix",(function(){return e})),r.d(n,"mat2",(function(){return i})),r.d(n,"mat2d",(function(){return u})),r.d(n,"mat3",(function(){return o})),r.d(n,"mat4",(function(){return a})),r.d(n,"quat",(function(){return f})),r.d(n,"quat2",(function(){return h})),r.d(n,"vec2",(function(){return l})),r.d(n,"vec3",(function(){return s})),r.d(n,"vec4",(function(){return c}))},function(t,n,r){"use strict";var e;Object.defineProperty(n,"__esModule",{value:!0}),function(t){t[t.RGB=1]="RGB",t[t.RGBA=2]="RGBA",t[t.LUMINANCE_ALPHA=3]="LUMINANCE_ALPHA",t[t.LUMINANCE=4]="LUMINANCE",t[t.ALPHA=5]="ALPHA",t[t.R8=6]="R8",t[t.R16F=7]="R16F",t[t.R32F=8]="R32F",t[t.R8UI=9]="R8UI",t[t.RG8=10]="RG8",t[t.RG16F=11]="RG16F",t[t.RG32F=12]="RG32F",t[t.RG8UI=13]="RG8UI",t[t.RGB8=14]="RGB8",t[t.SRGB8=15]="SRGB8",t[t.RGB565=16]="RGB565",t[t.R11F_G11F_B10F=17]="R11F_G11F_B10F",t[t.RGB9_E5=18]="RGB9_E5",t[t.RGB16F=19]="RGB16F",t[t.RGB32F=20]="RGB32F",t[t.RGB8UI=21]="RGB8UI",t[t.RGBA8=22]="RGBA8",t[t.SRGB8_ALPHA8=23]="SRGB8_ALPHA8",t[t.RGB5_A1=24]="RGB5_A1",t[t.RGB10_A2=25]="RGB10_A2",t[t.RGBA4=26]="RGBA4",t[t.RGBA16F=27]="RGBA16F",t[t.RGBA32F=28]="RGBA32F",t[t.RGBA8UI=29]="RGBA8UI",t[t.DEPTH_COMPONENT=30]="DEPTH_COMPONENT",t[t.DEPTH_STENCIL=31]="DEPTH_STENCIL"}(e=n.TextureFormat||(n.TextureFormat={})),n.mapGLFormat=function(t,n){return{[e.RGB]:[t.RGB,t.RGB,t.UNSIGNED_BYTE],[e.RGBA]:[t.RGBA,t.RGBA,t.UNSIGNED_BYTE],[e.LUMINANCE_ALPHA]:[t.LUMINANCE_ALPHA,t.LUMINANCE_ALPHA,t.UNSIGNED_BYTE],[e.LUMINANCE]:[t.LUMINANCE,t.LUMINANCE,t.UNSIGNED_BYTE],[e.ALPHA]:[t.ALPHA,t.ALPHA,t.UNSIGNED_BYTE],[e.R8]:[t.R8,t.RED,t.UNSIGNED_BYTE],[e.R16F]:[t.R16F,t.RED,t.HALF_FLOAT],[e.R32F]:[t.R32F,t.RED,t.FLOAT],[e.R8UI]:[t.R8UI,t.RED_INTEGER,t.UNSIGNED_BYTE],[e.RG8]:[t.RG8,t.RG,t.UNSIGNED_BYTE],[e.RG16F]:[t.RG16F,t.RG,t.HALF_FLOAT],[e.RG32F]:[t.RG32F,t.RG,t.FLOAT],[e.RG8UI]:[t.RG8UI,t.RG_INTEGER,t.UNSIGNED_BYTE],[e.RGB8]:[t.RGB8,t.RGB,t.UNSIGNED_BYTE],[e.SRGB8]:[t.SRGB8,t.RGB,t.UNSIGNED_BYTE],[e.RGB565]:[t.RGB565,t.RGB,t.UNSIGNED_BYTE],[e.R11F_G11F_B10F]:[t.R11F_G11F_B10F,t.RGB,t.UNSIGNED_INT_10F_11F_11F_REV],[e.RGB9_E5]:[t.RGB9_E5,t.RGB,t.HALF_FLOAT],[e.RGB16F]:[t.RGB16F,t.RGB,t.HALF_FLOAT],[e.RGB32F]:[t.RGB32F,t.RGB,t.FLOAT],[e.RGB8UI]:[t.RGB8UI,t.RGB_INTEGER,t.UNSIGNED_BYTE],[e.RGBA8]:[t.RGBA8,t.RGBA,t.UNSIGNED_BYTE],[e.SRGB8_ALPHA8]:[t.SRGB8_ALPHA8,t.RGBA,t.UNSIGNED_BYTE],[e.RGB5_A1]:[t.RGB5_A1,t.RGBA,t.UNSIGNED_BYTE],[e.RGB10_A2]:[t.RGB10_A2,t.RGBA,t.UNSIGNED_INT_2_10_10_10_REV],[e.RGBA4]:[t.RGBA4,t.RGBA,t.UNSIGNED_BYTE],[e.RGBA16F]:[t.RGBA16F,t.RGBA,t.HALF_FLOAT],[e.RGBA32F]:[t.RGBA32F,t.RGBA,t.FLOAT],[e.RGBA8UI]:[t.RGBA8UI,t.RGBA_INTEGER,t.UNSIGNED_BYTE],[e.DEPTH_COMPONENT]:[t.DEPTH_COMPONENT,t.DEPTH_COMPONENT,t.UNSIGNED_INT],[e.DEPTH_STENCIL]:[t.DEPTH_STENCIL,t.DEPTH_COMPONENT,t.UNSIGNED_INT]}[n]}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1),i=r(4),u=r(11),o=r(0);function a(t,n){return n.length>t.length?[n,t]:[t,n]}n.plus=function(t,n){const[r,e]=a(t,n);return e.to(r.constructor).plus(r)},n.minus=function(t,n){const[r,e]=a(t,n);return e.to(r.constructor).minus(r)},n.mul=function(t,n){if(t instanceof e.Vector3||t instanceof i.Vector4||t instanceof o.Vector2){const[r,e]=a(t,n);return e.to(r.constructor).mul(r)}{const r=n.clone();switch(n.constructor){case o.Vector2:u.vec2.transformMat4(r,n,t);break;case e.Vector3:u.vec3.transformMat4(r,n,t);break;default:u.vec4.transformMat4(r,n,t)}return r}},n.div=function(t,n){const[r,e]=a(t,n);return e.to(r.constructor).div(r)},n.dot=function(t,n){return t.dot(n)},n.cross=function(t,n){return t.cross(n)}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(11);function i(t){return e.mat4.clone(t)}n.Matrix4x4=i,i.identity=()=>{const t=e.mat4.create();return e.mat4.identity(t)},i.rts=(t,r,i)=>{const u=n.mat4.identity();return e.mat4.fromRotationTranslationScale(u,t,r,i),u},i.mul=(t,n,r)=>(r||(r=n,n=t,t=e.mat4.create()),e.mat4.mul(t,n,r)),n.mat4=i},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(11);function i(){return e.quat.create()}n.Quaternion=i,i.identity=()=>{const t=e.quat.create();return e.quat.identity(t),t},i.axis=(t,n)=>{const r=e.quat.create();e.quat.setAxisAngle(r,t,n)},n.quat=i},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});r(6)},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(1),i=r(0),u=r(5),o=r(3),a=r(2),s=r(13);n.Mesh=class{constructor(t=o.GL()){var n,r;this._verts=[],this._triangles=[],this._uvs=[],this._colors=[],this._normals=[],this.dirty=!0,this.uploaded=!1,this.vertices=new Float32Array(0),this.indices=new Uint32Array(0),this.gl=t,this.VBO=null!=(n=t.createBuffer())?n:a.panic("Failed to create vertex buffer."),this.EBO=null!=(r=t.createBuffer())?r:a.panic("Failed to create element buffer.")}get verts(){return this._verts}set verts(t){this._verts=t,this.dirty=!0}get triangles(){return this._triangles}set triangles(t){this._triangles=t,this.dirty=!0}get uvs(){return this._uvs}set uvs(t){this._uvs=t,this.dirty=!0}get colors(){return this._colors}set colors(t){this._colors=t,this.dirty=!0}get normals(){return this._normals}set normals(t){this._normals=t,this.dirty=!0}clear(){this.verts=[],this.uvs=[],this.triangles=[],this.colors=[],this.normals=[]}calculateNormals(t=0){if(this.triangles.length%3!=0)throw new Error("Invalid triangles.");this.normals=a.fillArray(()=>e.vec3(0,0,0),this.verts.length);for(let t=0;t<this.triangles.length;t+=3){const n=this.verts[this.triangles[t]],r=this.verts[this.triangles[t+1]],e=this.verts[this.triangles[t+2]],i=s.minus(r,n),u=s.minus(e,n),o=s.cross(i,u).normalise();this.normals[this.triangles[t]].plus(o)}for(let t=0;t<this.normals.length;t++)this.normals[t]=this.normals[t].normalise()}update(){if(this.dirty){if(this.triangles.length%3!=0)throw new Error("Invalid triangles.");if(this.colors.length!==this.verts.length&&(this.colors=[...this.colors,...a.fillArray(u.Color.white,this.verts.length-this.colors.length)]),this.uvs.length!==this.verts.length&&(this.uvs=[...this.uvs,...a.fillArray(i.vec2(0,0),this.verts.length-this.uvs.length)]),this.normals.length!==this.verts.length&&(this.normals=[...this.normals,...a.fillArray(e.vec3(0,0,0),this.verts.length-this.normals.length)]),this.vertices=new Float32Array(this.verts.flatMap((t,n)=>[...t,...this.colors[n],...this.uvs[n],...this.normals[n]])),this.vertices.length!=12*this.verts.length)throw new Error("Buffer with invalid length.");this.indices=new Uint32Array(this.triangles.flat()),this.dirty=!1,this.uploaded=!1}}setup(t){return this.update(),this.uploaded||(t.bindBuffer(t.ARRAY_BUFFER,this.VBO),t.bufferData(t.ARRAY_BUFFER,this.vertices,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.EBO),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),this.uploaded=!0),[this.VBO,this.EBO]}bind(t,n){this.setup(n);const r=t.attributes;n.bindBuffer(n.ARRAY_BUFFER,this.VBO),r.vert>=0&&(n.vertexAttribPointer(r.vert,3,n.FLOAT,!1,48,0),n.enableVertexAttribArray(r.vert)),r.color>=0&&(n.vertexAttribPointer(r.color,4,n.FLOAT,!1,48,12),n.enableVertexAttribArray(r.color)),r.uv>=0&&(n.vertexAttribPointer(r.uv,2,n.FLOAT,!1,48,28),n.enableVertexAttribArray(r.uv)),r.normal>=0&&(n.vertexAttribPointer(r.normal,3,n.FLOAT,!0,48,36),n.enableVertexAttribArray(r.uv)),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.EBO)}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(3),i=r(2),u={canvasOutput:{tex:null,attachPoint:WebGL2RenderingContext.BACK},fromRenderTexture:t=>({tex:t.glTex})};class o{constructor(t=0,n=0,r=e.GlobalContext()){var o;this.colorAttachments=[],this.depthAttachment=u.canvasOutput,this.isCanvasTarget=!0,this.width=t,this.height=n,this.frameBuffer=r?null!=(o=r.gl.createFramebuffer())?o:i.panic("Failed to create frame buffer"):null}addColorAttachment(t){if(null!==t){if(this.isCanvasTarget=!1,0==this.width&&0==this.height&&(this.width=t.width,this.height=t.height),this.width!=t.width||this.height!=t.height)throw new Error("Framebuffer attachments must in same resolution.");this.colorAttachments.push(u.fromRenderTexture(t))}}setDepthAttachment(t){var n,r;if(0==this.width&&0==this.height&&(this.width=t.width,this.height=t.height),this.width!=t.width||this.height!=t.height)throw new Error("Framebuffer attachments must in same resolution.");this.depthAttachment={tex:(r=null===(n=t)||void 0===n?void 0:n.glTex,null!=r?r:null),attachPoint:WebGL2RenderingContext.DEPTH_ATTACHMENT}}bind(t=e.GlobalContext()){const n=t.gl;if(this.isCanvasTarget)n.bindFramebuffer(n.FRAMEBUFFER,null),n.viewport(0,0,t.width,t.height);else{n.bindFramebuffer(n.FRAMEBUFFER,this.frameBuffer);let t=0;for(let r=0;r<this.colorAttachments.length;r++)this.colorAttachments[r].tex&&(this.colorAttachments[r].attachPoint=n.COLOR_ATTACHMENT0+t++,n.framebufferTexture2D(n.FRAMEBUFFER,this.colorAttachments[r].attachPoint,n.TEXTURE_2D,this.colorAttachments[r].tex,0));n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,this.depthAttachment.tex,0),n.viewport(0,0,this.width,this.height);const r=this.colorAttachments.map(t=>t.attachPoint);n.drawBuffers(r)}}release(t=e.GlobalContext()){if(this.isCanvasTarget)return;t.gl.deleteFramebuffer(this.frameBuffer)}}n.RenderTarget=o,o.CanvasTarget=Object.freeze(new o)},function(t,n,r){"use strict";r.r(n),n.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec3 aPos;\r\nin vec4 aColor;\r\nin vec2 aUV;\r\nin vec3 aNormal;\r\n\r\nuniform mat4 uTransformM;\r\nuniform mat4 uTransformVP;\r\nuniform mat4 uTransformMVP;\r\n\r\nuniform vec4 uColor;\r\nuniform vec2 uFlipUV;\r\n\r\nout vec4 vColor;\r\nout vec4 vPos;\r\nout vec2 vUV;\r\nout vec3 vNormal;\r\n\r\nvoid main()\r\n{\r\n    gl_Position = uTransformMVP * vec4(aPos, 1);\r\n    vColor = aColor * uColor;\r\n    vUV = (uFlipUV * (vec2(1) - aUV)) + ((vec2(1) - uFlipUV) * aUV);\r\n    vNormal = aNormal;\r\n}"},function(t,n,r){"use strict";function e(t){for(var r in t)n.hasOwnProperty(r)||(n[r]=t[r])}Object.defineProperty(n,"__esModule",{value:!0}),e(r(21)),e(r(22))},function(t,n,r){"use strict";function e(t){for(var r in t)n.hasOwnProperty(r)||(n[r]=t[r])}Object.defineProperty(n,"__esModule",{value:!0}),e(r(0)),e(r(1)),e(r(4)),e(r(5)),e(r(13)),e(r(14)),e(r(15))},function(t,n,r){"use strict";function e(t){for(var r in t)n.hasOwnProperty(r)||(n[r]=t[r])}Object.defineProperty(n,"__esModule",{value:!0}),e(r(6)),e(r(16)),e(r(17)),e(r(25)),e(r(9))},function(t,n){var r,e,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(n){try{return r.call(null,t,0)}catch(n){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:u}catch(t){r=u}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(t){e=o}}();var s,c=[],f=!1,h=-1;function l(){f&&s&&(f=!1,s.length?c=s.concat(c):h=-1,c.length&&d())}function d(){if(!f){var t=a(l);f=!0;for(var n=c.length;n;){for(s=c,c=[];++h<n;)s&&s[h].run();h=-1,n=c.length}s=null,f=!1,function(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}(t)}}function v(t,n){this.fun=t,this.array=n}function m(){}i.nextTick=function(t){var n=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)n[r-1]=arguments[r];c.push(new v(t,n)),1!==c.length||f||a(d)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,n){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(2),i=r(3),u=r(1),o=r(5),a=r(14),s=r(18),c=r(8),f=r(0),h=r(26),l=r(15);n.ZograRenderer=class{constructor(t,n,r){this.viewProjectionMatrix=a.mat4.identity(),this.target=s.RenderTarget.CanvasTarget,this.globalUniforms=new Map,this.globalTextures=new Map,this.canvas=t,this.width=void 0===n?t.width:n,this.height=void 0===r?t.height:r,this.canvas.width=this.width,this.canvas.height=this.height,this.gl=e.panicNull(this.canvas.getContext("webgl2"),"WebGL2 is not support on current device."),this.assets=new h.BuiltinAssets(this.gl),this.ctx={gl:this.gl,width:this.width,height:this.height,assets:this.assets},i.GlobalContext()||this.use()}use(){i.setGlobalContext(this.ctx)}setViewProjection(t){this.viewProjectionMatrix=t}setRenderTarget(t,n){if(t instanceof s.RenderTarget)this.target!==t&&this.target.release(),this.target=t;else if(t instanceof Array){this.target.release(),this.target=new s.RenderTarget(t[0].width,t[0].height,this.ctx);for(let n=0;n<t.length;n++)this.target.addColorAttachment(t[n])}else t instanceof c.RenderTexture&&(this.target.release(),this.target=new s.RenderTarget(t.width,t.height,this.ctx),this.target.addColorAttachment(t));n&&this.target.setDepthAttachment(n),this.target.bind(this.ctx)}clear(t=o.Color.black,n=!0){this.gl.clearColor(t.r,t.g,t.b,t.a),this.gl.clear(this.gl.COLOR_BUFFER_BIT|(n?this.gl.DEPTH_BUFFER_BIT:0))}blit(t,n,r=this.assets.materials.blitCopy){if(n instanceof c.RenderTexture){const t=new s.RenderTarget(n.width,n.height,this.ctx);t.addColorAttachment(n),n=t}else if(n instanceof Array){const t=new s.RenderTarget(0,0,this.ctx);for(let r=0;r<n.length;r++)t.addColorAttachment(n[r]);n=t}const e=this.viewProjectionMatrix,i=this.target;this.target=n,this.viewProjectionMatrix=a.mat4.identity(),this.setGlobalTexture("uMainTex",t),this.drawMesh(this.assets.meshes.quad,a.mat4.rts(l.quat.identity(),u.vec3(0,0,0),u.vec3(2,2,1)),r),this.unsetGlobalTexture("uMainTex"),this.target=i,this.viewProjectionMatrix=e}drawMesh(t,n,r){const e=this.gl,i={assets:this.assets,gl:e,nextTextureUnit:0,size:f.vec2(this.width,this.height)};this.target.bind(this.ctx),r.setup(i);const u=r.shader.program,o=a.mat4.mul(n,this.viewProjectionMatrix);r.shader.builtinUniformLocations.matM&&e.uniformMatrix4fv(r.shader.builtinUniformLocations.matM,!1,n),r.shader.builtinUniformLocations.matVP&&e.uniformMatrix4fv(r.shader.builtinUniformLocations.matVP,!1,this.viewProjectionMatrix),r.shader.builtinUniformLocations.matMVP&&e.uniformMatrix4fv(r.shader.builtinUniformLocations.matMVP,!1,o);for(const t of this.globalUniforms.values()){const n=e.getUniformLocation(u,t.name);if(n)switch(t.type){case"int":e.uniform1i(n,t.value);break;case"float":e.uniform1f(n,t.value);break;case"vec2":e.uniform2fv(n,t.value,0,2);break;case"vec3":e.uniform3fv(n,t.value,0,3);break;case"vec4":case"color":e.uniform4fv(n,t.value,0,4)}}for(const t of this.globalTextures.values()){const n=e.getUniformLocation(u,t.name);n&&t.texture.bind(n,i)}t.setup(e),t.bind(r.shader,e),e.drawElements(e.TRIANGLE_STRIP,t.triangles.length,e.UNSIGNED_INT,0)}setGlobalUniform(t,n,r){this.globalUniforms.set(t,{name:t,type:n,value:r})}unsetGlobalUniform(t){this.globalUniforms.delete(t)}setGlobalTexture(t,n){this.globalTextures.set(t,{name:t,texture:n})}unsetGlobalTexture(t){this.globalTextures.delete(t)}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(27),i=r(10),u=r(28),o=r(29);n.BuiltinAssets=class{constructor(t){let n={assets:this,gl:t,width:0,height:0};this.gl=t,this.BuiltinUniforms=i.BuiltinUniforms,this.shaderSources=i.BuiltinShaderSources,this.shaders=i.compileBuiltinShaders(t),this.meshes=o.createBuiltinMesh(t),this.DefaultTexture=u.createDefaultTexture(n),this.types=e.createBuiltinMaterialTypes(t,this.DefaultTexture),this.materials=e.createBuiltinMaterial(t,this.types)}}},function(t,n,r){"use strict";var e=this&&this.__decorate||function(t,n,r,e){var i,u=arguments.length,o=u<3?n:null===e?e=Object.getOwnPropertyDescriptor(n,r):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,r,e);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(o=(u<3?i(o):u>3?i(n,r,o):i(n,r))||o);return u>3&&o&&Object.defineProperty(n,r,o),o};Object.defineProperty(n,"__esModule",{value:!0});const i=r(9),u=r(10),o=r(6),a=r(5),s=(r(16),r(0));n.createDefaultMaterialType=function(t,n){const r=new i.Shader(u.BuiltinShaderSources.DefaultVert,u.BuiltinShaderSources.DefaultFrag,u.BuiltinShaderSources.DefaultShaderAttributes,t);let s=class extends(o.MaterialFromShader(r)){constructor(){super(...arguments),this.color=a.Color.white,this.mainTexture=n}};return e([o.shaderProp("uColor","color")],s.prototype,"color",void 0),e([o.shaderProp("uMainTex,","tex2d")],s.prototype,"mainTexture",void 0),s=e([o.materialDefine],s),s},n.createBuiltinMaterial=function(t,n){return{default:new n.DefaultMaterial(t),blitCopy:new n.BlitCopy(t)}},n.createBuiltinMaterialTypes=function(t,n){let r=class extends(o.MaterialFromShader(new i.Shader(u.BuiltinShaderSources.DefaultVert,u.BuiltinShaderSources.DefaultFrag,u.BuiltinShaderSources.DefaultShaderAttributes,t))){constructor(){super(...arguments),this.color=a.Color.white,this.mainTexture=n}};e([o.shaderProp("uColor","color")],r.prototype,"color",void 0),e([o.shaderProp("uMainTex,","tex2d")],r.prototype,"mainTexture",void 0),r=e([o.materialDefine],r);let c=class extends(o.MaterialFromShader(new i.Shader(u.BuiltinShaderSources.DefaultVert,u.BuiltinShaderSources.BlitCopyFrag,u.BuiltinShaderSources.DefaultShaderAttributes,t))){constructor(){super(...arguments),this.flip=s.vec2(0,0)}};return e([o.shaderProp("uFlip","vec2")],c.prototype,"flip",void 0),c=e([o.materialDefine],c),{DefaultMaterial:r,BlitCopy:c}}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(2),i=r(8),u=r(12);n.createDefaultTexture=function(t){var n;const r=document.createElement("canvas");r.width=r.height=64;const o=null!=(n=r.getContext("2d"))?n:e.panic("Failed to create default texture.");o.fillStyle="black",o.fillRect(0,0,64,64),o.fillStyle="cyan",o.fillRect(0,0,32,32),o.fillRect(32,32,32,32);const a=new i.Texture2D(64,64,u.TextureFormat.RGBA,i.FilterMode.Linear,t);return a.setData(r),a}},function(t,n,r){"use strict";Object.defineProperty(n,"__esModule",{value:!0});const e=r(17),i=r(1),u=r(0);n.createBuiltinMesh=function(t){const n=new e.Mesh(t);n.verts=[i.vec3(-.5,-.5,0),i.vec3(.5,-.5,0),i.vec3(.5,.5,0),i.vec3(-.5,.5,0)],n.triangles=[0,1,3,1,2,3],n.uvs=[u.vec2(0,0),u.vec2(1,0),u.vec2(1,1),u.vec2(0,1)],n.calculateNormals();const r=new e.Mesh(t);return r.verts=[i.vec3(-1,-1,0),i.vec3(1,-1,0),i.vec3(1,1,0),i.vec3(-1,1,0)],r.triangles=[0,1,3,1,2,3],r.uvs=[u.vec2(0,0),u.vec2(1,0),u.vec2(1,1),u.vec2(0,1)],r.calculateNormals(),{quad:n,screenQuad:r}}},function(t,n,r){var e=r(31),i=r(32);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var u={insert:"head",singleton:!1},o=(e(t.i,i,u),i.locals?i.locals:{});t.exports=o},function(t,n,r){"use strict";var e,i=function(){return void 0===e&&(e=Boolean(window&&document&&document.all&&!window.atob)),e},u=function(){var t={};return function(n){if(void 0===t[n]){var r=document.querySelector(n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[n]=r}return t[n]}}(),o={};function a(t,n,r){for(var e=0;e<n.length;e++){var i={css:n[e][1],media:n[e][2],sourceMap:n[e][3]};o[t][e]?o[t][e](i):o[t].push(m(i,r))}}function s(t){var n=document.createElement("style"),e=t.attributes||{};if(void 0===e.nonce){var i=r.nc;i&&(e.nonce=i)}if(Object.keys(e).forEach((function(t){n.setAttribute(t,e[t])})),"function"==typeof t.insert)t.insert(n);else{var o=u(t.insert||"head");if(!o)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");o.appendChild(n)}return n}var c,f=(c=[],function(t,n){return c[t]=n,c.filter(Boolean).join("\n")});function h(t,n,r,e){var i=r?"":e.css;if(t.styleSheet)t.styleSheet.cssText=f(n,i);else{var u=document.createTextNode(i),o=t.childNodes;o[n]&&t.removeChild(o[n]),o.length?t.insertBefore(u,o[n]):t.appendChild(u)}}function l(t,n,r){var e=r.css,i=r.media,u=r.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),u&&btoa&&(e+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(u))))," */")),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}var d=null,v=0;function m(t,n){var r,e,i;if(n.singleton){var u=v++;r=d||(d=s(n)),e=h.bind(null,r,u,!1),i=h.bind(null,r,u,!0)}else r=s(n),e=l.bind(null,r,n),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return e(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;e(t=n)}else i()}}t.exports=function(t,n,r){return(r=r||{}).singleton||"boolean"==typeof r.singleton||(r.singleton=i()),t=r.base?t+r.base:t,n=n||[],o[t]||(o[t]=[]),a(t,n,r),function(n){if(n=n||[],"[object Array]"===Object.prototype.toString.call(n)){o[t]||(o[t]=[]),a(t,n,r);for(var e=n.length;e<o[t].length;e++)o[t][e]();o[t].length=n.length,0===o[t].length&&delete o[t]}}}},function(t,n,r){(n=r(33)(!1)).push([t.i,"\r\nbody {\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100vw;\r\n    height: 100vh;\r\n    display: flex;\r\n    flex-flow: column nowrap;\r\n    align-items: center;\r\n    justify-content: center;\r\n    background-color: #EEE;\r\n    font-family: 'Open Sans', Roboto, Segoe UI, Microsoft Yahei UI, Tahoma, Geneva, Verdana, sans-serif;\r\n\r\n    background-position: 0px 0px,\r\n    16px 16px;\r\n    background-size: 32px 32px;\r\n    background-image: linear-gradient(45deg, #eee 25%, transparent 25%, transparent 75%, #eee 75%, #eee 100%),\r\n    linear-gradient(45deg, #eee 25%, white 25%, white 75%, #eee 75%, #eee 100%);\r\n\r\n}\r\n\r\n#root {\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n}\r\n\r\n#canvas {\r\n    max-width: 100%;\r\n    max-height: 100%;\r\n}",""]),t.exports=n},function(t,n,r){"use strict";t.exports=function(t){var n=[];return n.toString=function(){return this.map((function(n){var r=function(t,n){var r=t[1]||"",e=t[3];if(!e)return r;if(n&&"function"==typeof btoa){var i=(o=e,a=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),s="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(s," */")),u=e.sources.map((function(t){return"/*# sourceURL=".concat(e.sourceRoot||"").concat(t," */")}));return[r].concat(u).concat([i]).join("\n")}var o,a,s;return[r].join("\n")}(n,t);return n[2]?"@media ".concat(n[2]," {").concat(r,"}"):r})).join("")},n.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var e=0;e<t.length;e++){var i=[].concat(t[e]);r&&(i[2]?i[2]="".concat(r," and ").concat(i[2]):i[2]=r),n.push(i)}},n}},,,function(t,n,r){"use strict";var e,i=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))((function(i,u){function o(t){try{s(e.next(t))}catch(t){u(t)}}function a(t){try{s(e.throw(t))}catch(t){u(t)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,a)}s((e=e.apply(t,n||[])).next())}))},u=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n,"__esModule",{value:!0});const o=r(20),a=u(r(19)),s=u(r(37)),c=u(r(38));r(30);const f=u(r(39)),h=r(8),l=r(12),d=r(18),v=r(40),m=parseInt((e=/fps=(\d+)/.exec(window.location.search),null!=e?e:["","60"])[1]),p=o.vec2(650,850),M=document.querySelector("#canvas"),g=new o.ZograRenderer(M,window.innerWidth,window.innerHeight);class b extends(o.MaterialFromShader(new o.Shader(a.default,s.default))){}const y=new b,x=new o.Material(new o.Shader(a.default,c.default));x.setProp("uBlockSize","float",2),x.setProp("uTexelSize","vec4",o.vec4(2446,1840,1/2446,1/1840)),x.setProp("uOffset","vec2",p),x.setProp("uSize","vec3",o.vec3(window.innerWidth,window.innerHeight,window.innerWidth/window.innerHeight)),x.setProp("uBG","color",o.Color.white),x.setProp("uFG","color",o.rgba(0,0,0,.5)),g.clear();const T=[new h.RenderTexture(2446,1840,!1,l.TextureFormat.RGBA,h.FilterMode.Nearest),new h.RenderTexture(2446,1840,!1,l.TextureFormat.RGBA,h.FilterMode.Nearest)];T[0].wrapMode=h.WrapMode.Clamp,T[1].wrapMode=h.WrapMode.Clamp,T[0].update(),T[1].update();new h.RenderTexture(2446,1840,!1);const _=new o.Mesh;_.verts=[o.vec3(-1,-1,0),o.vec3(1,-1,0),o.vec3(1,1,0),o.vec3(-1,1,0)],_.triangles=[0,1,3,1,2,3],_.uvs=[o.vec2(0,0),o.vec2(1,0),o.vec2(1,1),o.vec2(0,1)],_.calculateNormals(),i(void 0,void 0,void 0,(function*(){let t=0,n=0;const r=yield function(){return i(this,void 0,void 0,(function*(){let t=0;const n=new ImageData(2446,1840),r=4500640;for(let t=0;t<3600512;t++){const t=4*Math.floor(Math.random()*r);n.data[t]=255}const e=yield v.loadImage(f.default);return T[0].setData(e),setInterval(()=>{const n=T[t%2],r=T[(t+1)%2];t++,g.setGlobalTexture("uLastFrame",n),g.setGlobalUniform("uSize","vec4",o.vec4(2446,1840,1/2446,1/1840)),g.setRenderTarget(r),g.drawMesh(_,o.mat4.identity(),y)},1e3/m),(n,r)=>{g.blit(T[t%2],d.RenderTarget.CanvasTarget,x)}}))}(),e=i=>{0===t&&(t=i,n=i);const u=(i-t)/1e3;t=i,r(u,(i-n)/1e3),requestAnimationFrame(e)};requestAnimationFrame(e)})),window.addEventListener("mousemove",t=>{const n=o.vec2(t.clientX,t.clientY),r=o.vec2(window.innerWidth/2,window.innerHeight/2),e=o.minus(n,r);e.mul(o.vec2(-.2,.2)),x.setProp("uOffset","vec2",o.plus(p,e))})},function(t,n,r){"use strict";r.r(n),n.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec4 vColor;\r\nin vec4 vPos;\r\nin vec2 vUV;\r\n\r\nuniform vec4 uSize;\r\nuniform sampler2D uLastFrame;\r\n\r\nlayout (location = 0) out vec4 nextFrame;\r\n//layout (location = 1) out vec4 fragColor;\r\n\r\nfloat clampTex(vec2 pos)\r\n{\r\n    float col = texture(uLastFrame, pos).r;\r\n    vec2 clmp = step(vec2(0), pos) * (vec2(1) - step(vec2(1), pos));\r\n    return clmp.x * clmp.y * col;\r\n}\r\n\r\nint neighbors(vec2 pos)\r\n{\r\n    int n = 0;\r\n    vec3 delta = vec3(-1, 0, 1);\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xy)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.xz)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.yx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.yz)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zx)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zy)));\r\n    n += int(step(.5, clampTex(pos + uSize.zw * delta.zz)));\r\n    return n;\r\n}\r\n\r\nvoid main()\r\n{\r\n    float current = step(.5, texture(uLastFrame, vUV).r);\r\n    int n = neighbors(vUV);\r\n    if(current == 1.0)\r\n    {\r\n        if(n < 2)\r\n            nextFrame = vec4(0);\r\n        else if (n > 3)\r\n            nextFrame = vec4(0);\r\n        else\r\n            nextFrame = vec4(current);\r\n    }\r\n    else\r\n    {\r\n        if(n == 3)\r\n            nextFrame = vec4(1);\r\n    }\r\n    //nextFrame = vec4(1.0 - current);\r\n    // vec2 pos = vUV;\r\n    // vec3 color = vec3(texture(uLastFrame, vUV).rrr);\r\n    // color = vec3(vUV, 0);\r\n    // fragColor = vec4(current, current, current, 1);\r\n}"},function(t,n,r){"use strict";r.r(n),n.default="#version 300 es\r\nprecision mediump float;\r\n\r\nin vec4 vColor;\r\nin vec4 vPos;\r\nin vec2 vUV;\r\nin vec3 vNormal;\r\n\r\nuniform sampler2D uMainTex;\r\nuniform vec4 uTexelSize;\r\nuniform float uBlockSize;\r\nuniform vec2 uOffset;\r\nuniform vec3 uSize;\r\nuniform vec4 uBG;\r\nuniform vec4 uFG;\r\n\r\nout vec4 fragColor;\r\n\r\nvoid main()\r\n{\r\n    vec2 uv = uOffset * uTexelSize.zw + vUV * uSize.xy / uBlockSize * uTexelSize.zw;\r\n    float alpha = texture(uMainTex, uv).r;\r\n    alpha *= uFG.a;\r\n\r\n    fragColor = vec4(uBG.rgb * vec3(1.0 - alpha) + uFG.rgb * vec3(alpha), uBG.a);\r\n}"},function(t,n,r){"use strict";r.r(n),n.default=r.p+"static/img/dual-gun.png"},function(t,n,r){"use strict";var e=this&&this.__awaiter||function(t,n,r,e){return new(r||(r=Promise))((function(i,u){function o(t){try{s(e.next(t))}catch(t){u(t)}}function a(t){try{s(e.throw(t))}catch(t){u(t)}}function s(t){var n;t.done?i(t.value):(n=t.value,n instanceof r?n:new r((function(t){t(n)}))).then(o,a)}s((e=e.apply(t,n||[])).next())}))};Object.defineProperty(n,"__esModule",{value:!0}),n.loadImage=function(t){return e(this,void 0,void 0,(function*(){return new Promise((n,r)=>{const e=new Image;e.src=t,e.complete&&n(e),e.onload=()=>{n(e)},e.onerror=(t,n,e,i,u)=>{r(u)}})}))}}]);